(()=>{"use strict";var t={181:(t,e,r)=>{r.r(e),r.d(e,{default:()=>n});const n="6797bfe95a3a7584105f4ebcc7511b44.png"},887:(t,e,r)=>{r.r(e),r.d(e,{glMatrix:()=>n,mat2:()=>a,mat2d:()=>o,mat3:()=>i,mat4:()=>s,quat:()=>l,quat2:()=>d,vec2:()=>h,vec3:()=>u,vec4:()=>c});var n={};r.r(n),r.d(n,{ARRAY_TYPE:()=>v,EPSILON:()=>f,RANDOM:()=>m,equals:()=>b,setMatrixArrayType:()=>g,toRadian:()=>p});var a={};r.r(a),r.d(a,{LDU:()=>C,add:()=>q,adjoint:()=>k,clone:()=>y,copy:()=>x,create:()=>_,determinant:()=>R,equals:()=>V,exactEquals:()=>N,frob:()=>I,fromRotation:()=>G,fromScaling:()=>L,fromValues:()=>A,identity:()=>w,invert:()=>T,mul:()=>O,multiply:()=>P,multiplyScalar:()=>z,multiplyScalarAndAdd:()=>Y,rotate:()=>F,scale:()=>D,set:()=>E,str:()=>U,sub:()=>Q,subtract:()=>B,transpose:()=>S});var o={};r.r(o),r.d(o,{add:()=>ct,clone:()=>H,copy:()=>K,create:()=>X,determinant:()=>$,equals:()=>vt,exactEquals:()=>ft,frob:()=>ut,fromRotation:()=>at,fromScaling:()=>ot,fromTranslation:()=>it,fromValues:()=>j,identity:()=>W,invert:()=>J,mul:()=>mt,multiply:()=>tt,multiplyScalar:()=>dt,multiplyScalarAndAdd:()=>ht,rotate:()=>et,scale:()=>rt,set:()=>Z,str:()=>st,sub:()=>gt,subtract:()=>lt,translate:()=>nt});var i={};r.r(i),r.d(i,{add:()=>Vt,adjoint:()=>St,clone:()=>bt,copy:()=>_t,create:()=>Mt,determinant:()=>Tt,equals:()=>Xt,exactEquals:()=>Qt,frob:()=>Nt,fromMat2d:()=>Ut,fromMat4:()=>pt,fromQuat:()=>It,fromRotation:()=>Gt,fromScaling:()=>Lt,fromTranslation:()=>Dt,fromValues:()=>yt,identity:()=>wt,invert:()=>Et,mul:()=>Ht,multiply:()=>kt,multiplyScalar:()=>Yt,multiplyScalarAndAdd:()=>Ot,normalFromMat4:()=>Ct,projection:()=>qt,rotate:()=>Pt,scale:()=>Ft,set:()=>xt,str:()=>Bt,sub:()=>Kt,subtract:()=>zt,translate:()=>Rt,transpose:()=>At});var s={};r.r(s),r.d(s,{add:()=>Le,adjoint:()=>ne,clone:()=>jt,copy:()=>Zt,create:()=>Wt,determinant:()=>ae,equals:()=>Be,exactEquals:()=>qe,frob:()=>Ge,fromQuat:()=>Ee,fromQuat2:()=>be,fromRotation:()=>ve,fromRotationTranslation:()=>pe,fromRotationTranslationScale:()=>we,fromRotationTranslationScaleOrigin:()=>Ae,fromScaling:()=>fe,fromTranslation:()=>he,fromValues:()=>Jt,fromXRotation:()=>me,fromYRotation:()=>ge,fromZRotation:()=>Me,frustum:()=>Se,getRotation:()=>xe,getScaling:()=>ye,getTranslation:()=>_e,identity:()=>te,invert:()=>re,lookAt:()=>Pe,mul:()=>Ne,multiply:()=>oe,multiplyScalar:()=>Ie,multiplyScalarAndAdd:()=>Ce,ortho:()=>Re,perspective:()=>Te,perspectiveFromFieldOfView:()=>ke,rotate:()=>ue,rotateX:()=>ce,rotateY:()=>le,rotateZ:()=>de,scale:()=>se,set:()=>$t,str:()=>De,sub:()=>Ve,subtract:()=>Ue,targetTo:()=>Fe,translate:()=>ie,transpose:()=>ee});var u={};r.r(u),r.d(u,{add:()=>Ke,angle:()=>wr,bezier:()=>mr,ceil:()=>Je,clone:()=>Ye,copy:()=>Xe,create:()=>ze,cross:()=>hr,dist:()=>Dr,distance:()=>or,div:()=>Fr,divide:()=>Ze,dot:()=>dr,equals:()=>Tr,exactEquals:()=>Sr,floor:()=>$e,forEach:()=>Ir,fromValues:()=>Qe,hermite:()=>vr,inverse:()=>cr,len:()=>Lr,length:()=>Oe,lerp:()=>fr,max:()=>er,min:()=>tr,mul:()=>Pr,multiply:()=>je,negate:()=>ur,normalize:()=>lr,random:()=>gr,rotateX:()=>_r,rotateY:()=>yr,rotateZ:()=>xr,round:()=>rr,scale:()=>nr,scaleAndAdd:()=>ar,set:()=>He,sqrDist:()=>Gr,sqrLen:()=>Ur,squaredDistance:()=>ir,squaredLength:()=>sr,str:()=>Er,sub:()=>Rr,subtract:()=>We,transformMat3:()=>pr,transformMat4:()=>Mr,transformQuat:()=>br,zero:()=>Ar});var c={};r.r(c),r.d(c,{add:()=>zr,ceil:()=>Xr,clone:()=>qr,copy:()=>Nr,create:()=>Cr,cross:()=>un,dist:()=>_n,distance:()=>$r,div:()=>bn,divide:()=>Qr,dot:()=>sn,equals:()=>gn,exactEquals:()=>mn,floor:()=>Hr,forEach:()=>An,fromValues:()=>Br,inverse:()=>an,len:()=>xn,length:()=>en,lerp:()=>cn,max:()=>Wr,min:()=>Kr,mul:()=>pn,multiply:()=>Or,negate:()=>nn,normalize:()=>on,random:()=>ln,round:()=>jr,scale:()=>Zr,scaleAndAdd:()=>Jr,set:()=>Vr,sqrDist:()=>yn,sqrLen:()=>wn,squaredDistance:()=>tn,squaredLength:()=>rn,str:()=>vn,sub:()=>Mn,subtract:()=>Yr,transformMat4:()=>dn,transformQuat:()=>hn,zero:()=>fn});var l={};r.r(l),r.d(l,{add:()=>ea,calculateW:()=>Ln,clone:()=>Zn,conjugate:()=>Vn,copy:()=>$n,create:()=>En,dot:()=>aa,equals:()=>ha,exactEquals:()=>da,exp:()=>Un,fromEuler:()=>Yn,fromMat3:()=>zn,fromValues:()=>Jn,getAngle:()=>Rn,getAxisAngle:()=>kn,identity:()=>Sn,invert:()=>Nn,len:()=>sa,length:()=>ia,lerp:()=>oa,ln:()=>In,mul:()=>ra,multiply:()=>Pn,normalize:()=>la,pow:()=>Cn,random:()=>Bn,rotateX:()=>Fn,rotateY:()=>Dn,rotateZ:()=>Gn,rotationTo:()=>fa,scale:()=>na,set:()=>ta,setAxes:()=>ma,setAxisAngle:()=>Tn,slerp:()=>qn,sqlerp:()=>va,sqrLen:()=>ca,squaredLength:()=>ua,str:()=>On});var d={};r.r(d),r.d(d,{add:()=>Ba,clone:()=>Ma,conjugate:()=>Xa,copy:()=>Aa,create:()=>ga,dot:()=>Ya,equals:()=>to,exactEquals:()=>$a,fromMat4:()=>wa,fromRotation:()=>xa,fromRotationTranslation:()=>_a,fromRotationTranslationValues:()=>ba,fromTranslation:()=>ya,fromValues:()=>pa,getDual:()=>ka,getReal:()=>Ta,getTranslation:()=>Fa,identity:()=>Ea,invert:()=>Qa,len:()=>Ka,length:()=>Ha,lerp:()=>Oa,mul:()=>Va,multiply:()=>Na,normalize:()=>Za,rotateAroundAxis:()=>qa,rotateByQuatAppend:()=>Ia,rotateByQuatPrepend:()=>Ca,rotateX:()=>Ga,rotateY:()=>La,rotateZ:()=>Ua,scale:()=>za,set:()=>Sa,setDual:()=>Pa,setReal:()=>Ra,sqrLen:()=>ja,squaredLength:()=>Wa,str:()=>Ja,translate:()=>Da});var h={};r.r(h),r.d(h,{add:()=>io,angle:()=>Lo,ceil:()=>lo,clone:()=>ro,copy:()=>ao,create:()=>eo,cross:()=>So,dist:()=>Yo,distance:()=>po,div:()=>zo,divide:()=>co,dot:()=>Eo,equals:()=>qo,exactEquals:()=>Co,floor:()=>ho,forEach:()=>Xo,fromValues:()=>no,inverse:()=>wo,len:()=>Bo,length:()=>_o,lerp:()=>To,max:()=>vo,min:()=>fo,mul:()=>Vo,multiply:()=>uo,negate:()=>xo,normalize:()=>Ao,random:()=>ko,rotate:()=>Go,round:()=>mo,scale:()=>go,scaleAndAdd:()=>Mo,set:()=>oo,sqrDist:()=>Oo,sqrLen:()=>Qo,squaredDistance:()=>bo,squaredLength:()=>yo,str:()=>Io,sub:()=>No,subtract:()=>so,transformMat2:()=>Ro,transformMat2d:()=>Po,transformMat3:()=>Fo,transformMat4:()=>Do,zero:()=>Uo});var f=1e-6,v="undefined"!=typeof Float32Array?Float32Array:Array,m=Math.random;function g(t){v=t}var M=Math.PI/180;function p(t){return t*M}function b(t,e){return Math.abs(t-e)<=f*Math.max(1,Math.abs(t),Math.abs(e))}function _(){var t=new v(4);return v!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t}function y(t){var e=new v(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function x(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function w(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t}function A(t,e,r,n){var a=new v(4);return a[0]=t,a[1]=e,a[2]=r,a[3]=n,a}function E(t,e,r,n,a){return t[0]=e,t[1]=r,t[2]=n,t[3]=a,t}function S(t,e){if(t===e){var r=e[1];t[1]=e[2],t[2]=r}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t}function T(t,e){var r=e[0],n=e[1],a=e[2],o=e[3],i=r*o-a*n;return i?(i=1/i,t[0]=o*i,t[1]=-n*i,t[2]=-a*i,t[3]=r*i,t):null}function k(t,e){var r=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=r,t}function R(t){return t[0]*t[3]-t[2]*t[1]}function P(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],s=r[0],u=r[1],c=r[2],l=r[3];return t[0]=n*s+o*u,t[1]=a*s+i*u,t[2]=n*c+o*l,t[3]=a*c+i*l,t}function F(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],s=Math.sin(r),u=Math.cos(r);return t[0]=n*u+o*s,t[1]=a*u+i*s,t[2]=n*-s+o*u,t[3]=a*-s+i*u,t}function D(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],s=r[0],u=r[1];return t[0]=n*s,t[1]=a*s,t[2]=o*u,t[3]=i*u,t}function G(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=-r,t[3]=n,t}function L(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t}function U(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function I(t){return Math.hypot(t[0],t[1],t[2],t[3])}function C(t,e,r,n){return t[2]=n[2]/n[0],r[0]=n[0],r[1]=n[1],r[3]=n[3]-t[2]*r[1],[t,e,r]}function q(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t}function B(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t}function N(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function V(t,e){var r=t[0],n=t[1],a=t[2],o=t[3],i=e[0],s=e[1],u=e[2],c=e[3];return Math.abs(r-i)<=f*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(n-s)<=f*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(a-u)<=f*Math.max(1,Math.abs(a),Math.abs(u))&&Math.abs(o-c)<=f*Math.max(1,Math.abs(o),Math.abs(c))}function z(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t}function Y(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var O=P,Q=B;function X(){var t=new v(6);return v!=Float32Array&&(t[1]=0,t[2]=0,t[4]=0,t[5]=0),t[0]=1,t[3]=1,t}function H(t){var e=new v(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function K(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function W(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}function j(t,e,r,n,a,o){var i=new v(6);return i[0]=t,i[1]=e,i[2]=r,i[3]=n,i[4]=a,i[5]=o,i}function Z(t,e,r,n,a,o,i){return t[0]=e,t[1]=r,t[2]=n,t[3]=a,t[4]=o,t[5]=i,t}function J(t,e){var r=e[0],n=e[1],a=e[2],o=e[3],i=e[4],s=e[5],u=r*o-n*a;return u?(u=1/u,t[0]=o*u,t[1]=-n*u,t[2]=-a*u,t[3]=r*u,t[4]=(a*s-o*i)*u,t[5]=(n*i-r*s)*u,t):null}function $(t){return t[0]*t[3]-t[1]*t[2]}function tt(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],s=e[4],u=e[5],c=r[0],l=r[1],d=r[2],h=r[3],f=r[4],v=r[5];return t[0]=n*c+o*l,t[1]=a*c+i*l,t[2]=n*d+o*h,t[3]=a*d+i*h,t[4]=n*f+o*v+s,t[5]=a*f+i*v+u,t}function et(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],s=e[4],u=e[5],c=Math.sin(r),l=Math.cos(r);return t[0]=n*l+o*c,t[1]=a*l+i*c,t[2]=n*-c+o*l,t[3]=a*-c+i*l,t[4]=s,t[5]=u,t}function rt(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],s=e[4],u=e[5],c=r[0],l=r[1];return t[0]=n*c,t[1]=a*c,t[2]=o*l,t[3]=i*l,t[4]=s,t[5]=u,t}function nt(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],s=e[4],u=e[5],c=r[0],l=r[1];return t[0]=n,t[1]=a,t[2]=o,t[3]=i,t[4]=n*c+o*l+s,t[5]=a*c+i*l+u,t}function at(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=-r,t[3]=n,t[4]=0,t[5]=0,t}function ot(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t}function it(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t}function st(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"}function ut(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],1)}function ct(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t}function lt(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t}function dt(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t}function ht(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t}function ft(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]}function vt(t,e){var r=t[0],n=t[1],a=t[2],o=t[3],i=t[4],s=t[5],u=e[0],c=e[1],l=e[2],d=e[3],h=e[4],v=e[5];return Math.abs(r-u)<=f*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(n-c)<=f*Math.max(1,Math.abs(n),Math.abs(c))&&Math.abs(a-l)<=f*Math.max(1,Math.abs(a),Math.abs(l))&&Math.abs(o-d)<=f*Math.max(1,Math.abs(o),Math.abs(d))&&Math.abs(i-h)<=f*Math.max(1,Math.abs(i),Math.abs(h))&&Math.abs(s-v)<=f*Math.max(1,Math.abs(s),Math.abs(v))}var mt=tt,gt=lt;function Mt(){var t=new v(9);return v!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function pt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function bt(t){var e=new v(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function _t(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function yt(t,e,r,n,a,o,i,s,u){var c=new v(9);return c[0]=t,c[1]=e,c[2]=r,c[3]=n,c[4]=a,c[5]=o,c[6]=i,c[7]=s,c[8]=u,c}function xt(t,e,r,n,a,o,i,s,u,c){return t[0]=e,t[1]=r,t[2]=n,t[3]=a,t[4]=o,t[5]=i,t[6]=s,t[7]=u,t[8]=c,t}function wt(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function At(t,e){if(t===e){var r=e[1],n=e[2],a=e[5];t[1]=e[3],t[2]=e[6],t[3]=r,t[5]=e[7],t[6]=n,t[7]=a}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function Et(t,e){var r=e[0],n=e[1],a=e[2],o=e[3],i=e[4],s=e[5],u=e[6],c=e[7],l=e[8],d=l*i-s*c,h=-l*o+s*u,f=c*o-i*u,v=r*d+n*h+a*f;return v?(v=1/v,t[0]=d*v,t[1]=(-l*n+a*c)*v,t[2]=(s*n-a*i)*v,t[3]=h*v,t[4]=(l*r-a*u)*v,t[5]=(-s*r+a*o)*v,t[6]=f*v,t[7]=(-c*r+n*u)*v,t[8]=(i*r-n*o)*v,t):null}function St(t,e){var r=e[0],n=e[1],a=e[2],o=e[3],i=e[4],s=e[5],u=e[6],c=e[7],l=e[8];return t[0]=i*l-s*c,t[1]=a*c-n*l,t[2]=n*s-a*i,t[3]=s*u-o*l,t[4]=r*l-a*u,t[5]=a*o-r*s,t[6]=o*c-i*u,t[7]=n*u-r*c,t[8]=r*i-n*o,t}function Tt(t){var e=t[0],r=t[1],n=t[2],a=t[3],o=t[4],i=t[5],s=t[6],u=t[7],c=t[8];return e*(c*o-i*u)+r*(-c*a+i*s)+n*(u*a-o*s)}function kt(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],s=e[4],u=e[5],c=e[6],l=e[7],d=e[8],h=r[0],f=r[1],v=r[2],m=r[3],g=r[4],M=r[5],p=r[6],b=r[7],_=r[8];return t[0]=h*n+f*i+v*c,t[1]=h*a+f*s+v*l,t[2]=h*o+f*u+v*d,t[3]=m*n+g*i+M*c,t[4]=m*a+g*s+M*l,t[5]=m*o+g*u+M*d,t[6]=p*n+b*i+_*c,t[7]=p*a+b*s+_*l,t[8]=p*o+b*u+_*d,t}function Rt(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],s=e[4],u=e[5],c=e[6],l=e[7],d=e[8],h=r[0],f=r[1];return t[0]=n,t[1]=a,t[2]=o,t[3]=i,t[4]=s,t[5]=u,t[6]=h*n+f*i+c,t[7]=h*a+f*s+l,t[8]=h*o+f*u+d,t}function Pt(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],s=e[4],u=e[5],c=e[6],l=e[7],d=e[8],h=Math.sin(r),f=Math.cos(r);return t[0]=f*n+h*i,t[1]=f*a+h*s,t[2]=f*o+h*u,t[3]=f*i-h*n,t[4]=f*s-h*a,t[5]=f*u-h*o,t[6]=c,t[7]=l,t[8]=d,t}function Ft(t,e,r){var n=r[0],a=r[1];return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=a*e[3],t[4]=a*e[4],t[5]=a*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function Dt(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t}function Gt(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=0,t[3]=-r,t[4]=n,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Lt(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Ut(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t}function It(t,e){var r=e[0],n=e[1],a=e[2],o=e[3],i=r+r,s=n+n,u=a+a,c=r*i,l=n*i,d=n*s,h=a*i,f=a*s,v=a*u,m=o*i,g=o*s,M=o*u;return t[0]=1-d-v,t[3]=l-M,t[6]=h+g,t[1]=l+M,t[4]=1-c-v,t[7]=f-m,t[2]=h-g,t[5]=f+m,t[8]=1-c-d,t}function Ct(t,e){var r=e[0],n=e[1],a=e[2],o=e[3],i=e[4],s=e[5],u=e[6],c=e[7],l=e[8],d=e[9],h=e[10],f=e[11],v=e[12],m=e[13],g=e[14],M=e[15],p=r*s-n*i,b=r*u-a*i,_=r*c-o*i,y=n*u-a*s,x=n*c-o*s,w=a*c-o*u,A=l*m-d*v,E=l*g-h*v,S=l*M-f*v,T=d*g-h*m,k=d*M-f*m,R=h*M-f*g,P=p*R-b*k+_*T+y*S-x*E+w*A;return P?(P=1/P,t[0]=(s*R-u*k+c*T)*P,t[1]=(u*S-i*R-c*E)*P,t[2]=(i*k-s*S+c*A)*P,t[3]=(a*k-n*R-o*T)*P,t[4]=(r*R-a*S+o*E)*P,t[5]=(n*S-r*k-o*A)*P,t[6]=(m*w-g*x+M*y)*P,t[7]=(g*_-v*w-M*b)*P,t[8]=(v*x-m*_+M*p)*P,t):null}function qt(t,e,r){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/r,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function Bt(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function Nt(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])}function Vt(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t}function zt(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t}function Yt(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t}function Ot(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t[6]=e[6]+r[6]*n,t[7]=e[7]+r[7]*n,t[8]=e[8]+r[8]*n,t}function Qt(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]}function Xt(t,e){var r=t[0],n=t[1],a=t[2],o=t[3],i=t[4],s=t[5],u=t[6],c=t[7],l=t[8],d=e[0],h=e[1],v=e[2],m=e[3],g=e[4],M=e[5],p=e[6],b=e[7],_=e[8];return Math.abs(r-d)<=f*Math.max(1,Math.abs(r),Math.abs(d))&&Math.abs(n-h)<=f*Math.max(1,Math.abs(n),Math.abs(h))&&Math.abs(a-v)<=f*Math.max(1,Math.abs(a),Math.abs(v))&&Math.abs(o-m)<=f*Math.max(1,Math.abs(o),Math.abs(m))&&Math.abs(i-g)<=f*Math.max(1,Math.abs(i),Math.abs(g))&&Math.abs(s-M)<=f*Math.max(1,Math.abs(s),Math.abs(M))&&Math.abs(u-p)<=f*Math.max(1,Math.abs(u),Math.abs(p))&&Math.abs(c-b)<=f*Math.max(1,Math.abs(c),Math.abs(b))&&Math.abs(l-_)<=f*Math.max(1,Math.abs(l),Math.abs(_))}var Ht=kt,Kt=zt;function Wt(){var t=new v(16);return v!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function jt(t){var e=new v(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Zt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Jt(t,e,r,n,a,o,i,s,u,c,l,d,h,f,m,g){var M=new v(16);return M[0]=t,M[1]=e,M[2]=r,M[3]=n,M[4]=a,M[5]=o,M[6]=i,M[7]=s,M[8]=u,M[9]=c,M[10]=l,M[11]=d,M[12]=h,M[13]=f,M[14]=m,M[15]=g,M}function $t(t,e,r,n,a,o,i,s,u,c,l,d,h,f,v,m,g){return t[0]=e,t[1]=r,t[2]=n,t[3]=a,t[4]=o,t[5]=i,t[6]=s,t[7]=u,t[8]=c,t[9]=l,t[10]=d,t[11]=h,t[12]=f,t[13]=v,t[14]=m,t[15]=g,t}function te(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ee(t,e){if(t===e){var r=e[1],n=e[2],a=e[3],o=e[6],i=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=n,t[9]=o,t[11]=e[14],t[12]=a,t[13]=i,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function re(t,e){var r=e[0],n=e[1],a=e[2],o=e[3],i=e[4],s=e[5],u=e[6],c=e[7],l=e[8],d=e[9],h=e[10],f=e[11],v=e[12],m=e[13],g=e[14],M=e[15],p=r*s-n*i,b=r*u-a*i,_=r*c-o*i,y=n*u-a*s,x=n*c-o*s,w=a*c-o*u,A=l*m-d*v,E=l*g-h*v,S=l*M-f*v,T=d*g-h*m,k=d*M-f*m,R=h*M-f*g,P=p*R-b*k+_*T+y*S-x*E+w*A;return P?(P=1/P,t[0]=(s*R-u*k+c*T)*P,t[1]=(a*k-n*R-o*T)*P,t[2]=(m*w-g*x+M*y)*P,t[3]=(h*x-d*w-f*y)*P,t[4]=(u*S-i*R-c*E)*P,t[5]=(r*R-a*S+o*E)*P,t[6]=(g*_-v*w-M*b)*P,t[7]=(l*w-h*_+f*b)*P,t[8]=(i*k-s*S+c*A)*P,t[9]=(n*S-r*k-o*A)*P,t[10]=(v*x-m*_+M*p)*P,t[11]=(d*_-l*x-f*p)*P,t[12]=(s*E-i*T-u*A)*P,t[13]=(r*T-n*E+a*A)*P,t[14]=(m*b-v*y-g*p)*P,t[15]=(l*y-d*b+h*p)*P,t):null}function ne(t,e){var r=e[0],n=e[1],a=e[2],o=e[3],i=e[4],s=e[5],u=e[6],c=e[7],l=e[8],d=e[9],h=e[10],f=e[11],v=e[12],m=e[13],g=e[14],M=e[15];return t[0]=s*(h*M-f*g)-d*(u*M-c*g)+m*(u*f-c*h),t[1]=-(n*(h*M-f*g)-d*(a*M-o*g)+m*(a*f-o*h)),t[2]=n*(u*M-c*g)-s*(a*M-o*g)+m*(a*c-o*u),t[3]=-(n*(u*f-c*h)-s*(a*f-o*h)+d*(a*c-o*u)),t[4]=-(i*(h*M-f*g)-l*(u*M-c*g)+v*(u*f-c*h)),t[5]=r*(h*M-f*g)-l*(a*M-o*g)+v*(a*f-o*h),t[6]=-(r*(u*M-c*g)-i*(a*M-o*g)+v*(a*c-o*u)),t[7]=r*(u*f-c*h)-i*(a*f-o*h)+l*(a*c-o*u),t[8]=i*(d*M-f*m)-l*(s*M-c*m)+v*(s*f-c*d),t[9]=-(r*(d*M-f*m)-l*(n*M-o*m)+v*(n*f-o*d)),t[10]=r*(s*M-c*m)-i*(n*M-o*m)+v*(n*c-o*s),t[11]=-(r*(s*f-c*d)-i*(n*f-o*d)+l*(n*c-o*s)),t[12]=-(i*(d*g-h*m)-l*(s*g-u*m)+v*(s*h-u*d)),t[13]=r*(d*g-h*m)-l*(n*g-a*m)+v*(n*h-a*d),t[14]=-(r*(s*g-u*m)-i*(n*g-a*m)+v*(n*u-a*s)),t[15]=r*(s*h-u*d)-i*(n*h-a*d)+l*(n*u-a*s),t}function ae(t){var e=t[0],r=t[1],n=t[2],a=t[3],o=t[4],i=t[5],s=t[6],u=t[7],c=t[8],l=t[9],d=t[10],h=t[11],f=t[12],v=t[13],m=t[14],g=t[15];return(e*i-r*o)*(d*g-h*m)-(e*s-n*o)*(l*g-h*v)+(e*u-a*o)*(l*m-d*v)+(r*s-n*i)*(c*g-h*f)-(r*u-a*i)*(c*m-d*f)+(n*u-a*s)*(c*v-l*f)}function oe(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],s=e[4],u=e[5],c=e[6],l=e[7],d=e[8],h=e[9],f=e[10],v=e[11],m=e[12],g=e[13],M=e[14],p=e[15],b=r[0],_=r[1],y=r[2],x=r[3];return t[0]=b*n+_*s+y*d+x*m,t[1]=b*a+_*u+y*h+x*g,t[2]=b*o+_*c+y*f+x*M,t[3]=b*i+_*l+y*v+x*p,b=r[4],_=r[5],y=r[6],x=r[7],t[4]=b*n+_*s+y*d+x*m,t[5]=b*a+_*u+y*h+x*g,t[6]=b*o+_*c+y*f+x*M,t[7]=b*i+_*l+y*v+x*p,b=r[8],_=r[9],y=r[10],x=r[11],t[8]=b*n+_*s+y*d+x*m,t[9]=b*a+_*u+y*h+x*g,t[10]=b*o+_*c+y*f+x*M,t[11]=b*i+_*l+y*v+x*p,b=r[12],_=r[13],y=r[14],x=r[15],t[12]=b*n+_*s+y*d+x*m,t[13]=b*a+_*u+y*h+x*g,t[14]=b*o+_*c+y*f+x*M,t[15]=b*i+_*l+y*v+x*p,t}function ie(t,e,r){var n,a,o,i,s,u,c,l,d,h,f,v,m=r[0],g=r[1],M=r[2];return e===t?(t[12]=e[0]*m+e[4]*g+e[8]*M+e[12],t[13]=e[1]*m+e[5]*g+e[9]*M+e[13],t[14]=e[2]*m+e[6]*g+e[10]*M+e[14],t[15]=e[3]*m+e[7]*g+e[11]*M+e[15]):(n=e[0],a=e[1],o=e[2],i=e[3],s=e[4],u=e[5],c=e[6],l=e[7],d=e[8],h=e[9],f=e[10],v=e[11],t[0]=n,t[1]=a,t[2]=o,t[3]=i,t[4]=s,t[5]=u,t[6]=c,t[7]=l,t[8]=d,t[9]=h,t[10]=f,t[11]=v,t[12]=n*m+s*g+d*M+e[12],t[13]=a*m+u*g+h*M+e[13],t[14]=o*m+c*g+f*M+e[14],t[15]=i*m+l*g+v*M+e[15]),t}function se(t,e,r){var n=r[0],a=r[1],o=r[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*a,t[5]=e[5]*a,t[6]=e[6]*a,t[7]=e[7]*a,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function ue(t,e,r,n){var a,o,i,s,u,c,l,d,h,v,m,g,M,p,b,_,y,x,w,A,E,S,T,k,R=n[0],P=n[1],F=n[2],D=Math.hypot(R,P,F);return D<f?null:(R*=D=1/D,P*=D,F*=D,a=Math.sin(r),i=1-(o=Math.cos(r)),s=e[0],u=e[1],c=e[2],l=e[3],d=e[4],h=e[5],v=e[6],m=e[7],g=e[8],M=e[9],p=e[10],b=e[11],_=R*R*i+o,y=P*R*i+F*a,x=F*R*i-P*a,w=R*P*i-F*a,A=P*P*i+o,E=F*P*i+R*a,S=R*F*i+P*a,T=P*F*i-R*a,k=F*F*i+o,t[0]=s*_+d*y+g*x,t[1]=u*_+h*y+M*x,t[2]=c*_+v*y+p*x,t[3]=l*_+m*y+b*x,t[4]=s*w+d*A+g*E,t[5]=u*w+h*A+M*E,t[6]=c*w+v*A+p*E,t[7]=l*w+m*A+b*E,t[8]=s*S+d*T+g*k,t[9]=u*S+h*T+M*k,t[10]=c*S+v*T+p*k,t[11]=l*S+m*T+b*k,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function ce(t,e,r){var n=Math.sin(r),a=Math.cos(r),o=e[4],i=e[5],s=e[6],u=e[7],c=e[8],l=e[9],d=e[10],h=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*a+c*n,t[5]=i*a+l*n,t[6]=s*a+d*n,t[7]=u*a+h*n,t[8]=c*a-o*n,t[9]=l*a-i*n,t[10]=d*a-s*n,t[11]=h*a-u*n,t}function le(t,e,r){var n=Math.sin(r),a=Math.cos(r),o=e[0],i=e[1],s=e[2],u=e[3],c=e[8],l=e[9],d=e[10],h=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*a-c*n,t[1]=i*a-l*n,t[2]=s*a-d*n,t[3]=u*a-h*n,t[8]=o*n+c*a,t[9]=i*n+l*a,t[10]=s*n+d*a,t[11]=u*n+h*a,t}function de(t,e,r){var n=Math.sin(r),a=Math.cos(r),o=e[0],i=e[1],s=e[2],u=e[3],c=e[4],l=e[5],d=e[6],h=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*a+c*n,t[1]=i*a+l*n,t[2]=s*a+d*n,t[3]=u*a+h*n,t[4]=c*a-o*n,t[5]=l*a-i*n,t[6]=d*a-s*n,t[7]=h*a-u*n,t}function he(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function fe(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ve(t,e,r){var n,a,o,i=r[0],s=r[1],u=r[2],c=Math.hypot(i,s,u);return c<f?null:(i*=c=1/c,s*=c,u*=c,n=Math.sin(e),o=1-(a=Math.cos(e)),t[0]=i*i*o+a,t[1]=s*i*o+u*n,t[2]=u*i*o-s*n,t[3]=0,t[4]=i*s*o-u*n,t[5]=s*s*o+a,t[6]=u*s*o+i*n,t[7]=0,t[8]=i*u*o+s*n,t[9]=s*u*o-i*n,t[10]=u*u*o+a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function me(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n,t[6]=r,t[7]=0,t[8]=0,t[9]=-r,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ge(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=0,t[2]=-r,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=r,t[9]=0,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Me(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=0,t[3]=0,t[4]=-r,t[5]=n,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function pe(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],s=n+n,u=a+a,c=o+o,l=n*s,d=n*u,h=n*c,f=a*u,v=a*c,m=o*c,g=i*s,M=i*u,p=i*c;return t[0]=1-(f+m),t[1]=d+p,t[2]=h-M,t[3]=0,t[4]=d-p,t[5]=1-(l+m),t[6]=v+g,t[7]=0,t[8]=h+M,t[9]=v-g,t[10]=1-(l+f),t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function be(t,e){var r=new v(3),n=-e[0],a=-e[1],o=-e[2],i=e[3],s=e[4],u=e[5],c=e[6],l=e[7],d=n*n+a*a+o*o+i*i;return d>0?(r[0]=2*(s*i+l*n+u*o-c*a)/d,r[1]=2*(u*i+l*a+c*n-s*o)/d,r[2]=2*(c*i+l*o+s*a-u*n)/d):(r[0]=2*(s*i+l*n+u*o-c*a),r[1]=2*(u*i+l*a+c*n-s*o),r[2]=2*(c*i+l*o+s*a-u*n)),pe(t,e,r),t}function _e(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function ye(t,e){var r=e[0],n=e[1],a=e[2],o=e[4],i=e[5],s=e[6],u=e[8],c=e[9],l=e[10];return t[0]=Math.hypot(r,n,a),t[1]=Math.hypot(o,i,s),t[2]=Math.hypot(u,c,l),t}function xe(t,e){var r=new v(3);ye(r,e);var n=1/r[0],a=1/r[1],o=1/r[2],i=e[0]*n,s=e[1]*a,u=e[2]*o,c=e[4]*n,l=e[5]*a,d=e[6]*o,h=e[8]*n,f=e[9]*a,m=e[10]*o,g=i+l+m,M=0;return g>0?(M=2*Math.sqrt(g+1),t[3]=.25*M,t[0]=(d-f)/M,t[1]=(h-u)/M,t[2]=(s-c)/M):i>l&&i>m?(M=2*Math.sqrt(1+i-l-m),t[3]=(d-f)/M,t[0]=.25*M,t[1]=(s+c)/M,t[2]=(h+u)/M):l>m?(M=2*Math.sqrt(1+l-i-m),t[3]=(h-u)/M,t[0]=(s+c)/M,t[1]=.25*M,t[2]=(d+f)/M):(M=2*Math.sqrt(1+m-i-l),t[3]=(s-c)/M,t[0]=(h+u)/M,t[1]=(d+f)/M,t[2]=.25*M),t}function we(t,e,r,n){var a=e[0],o=e[1],i=e[2],s=e[3],u=a+a,c=o+o,l=i+i,d=a*u,h=a*c,f=a*l,v=o*c,m=o*l,g=i*l,M=s*u,p=s*c,b=s*l,_=n[0],y=n[1],x=n[2];return t[0]=(1-(v+g))*_,t[1]=(h+b)*_,t[2]=(f-p)*_,t[3]=0,t[4]=(h-b)*y,t[5]=(1-(d+g))*y,t[6]=(m+M)*y,t[7]=0,t[8]=(f+p)*x,t[9]=(m-M)*x,t[10]=(1-(d+v))*x,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function Ae(t,e,r,n,a){var o=e[0],i=e[1],s=e[2],u=e[3],c=o+o,l=i+i,d=s+s,h=o*c,f=o*l,v=o*d,m=i*l,g=i*d,M=s*d,p=u*c,b=u*l,_=u*d,y=n[0],x=n[1],w=n[2],A=a[0],E=a[1],S=a[2],T=(1-(m+M))*y,k=(f+_)*y,R=(v-b)*y,P=(f-_)*x,F=(1-(h+M))*x,D=(g+p)*x,G=(v+b)*w,L=(g-p)*w,U=(1-(h+m))*w;return t[0]=T,t[1]=k,t[2]=R,t[3]=0,t[4]=P,t[5]=F,t[6]=D,t[7]=0,t[8]=G,t[9]=L,t[10]=U,t[11]=0,t[12]=r[0]+A-(T*A+P*E+G*S),t[13]=r[1]+E-(k*A+F*E+L*S),t[14]=r[2]+S-(R*A+D*E+U*S),t[15]=1,t}function Ee(t,e){var r=e[0],n=e[1],a=e[2],o=e[3],i=r+r,s=n+n,u=a+a,c=r*i,l=n*i,d=n*s,h=a*i,f=a*s,v=a*u,m=o*i,g=o*s,M=o*u;return t[0]=1-d-v,t[1]=l+M,t[2]=h-g,t[3]=0,t[4]=l-M,t[5]=1-c-v,t[6]=f+m,t[7]=0,t[8]=h+g,t[9]=f-m,t[10]=1-c-d,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Se(t,e,r,n,a,o,i){var s=1/(r-e),u=1/(a-n),c=1/(o-i);return t[0]=2*o*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*u,t[6]=0,t[7]=0,t[8]=(r+e)*s,t[9]=(a+n)*u,t[10]=(i+o)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=i*o*2*c,t[15]=0,t}function Te(t,e,r,n,a){var o,i=1/Math.tan(e/2);return t[0]=i/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=a&&a!==1/0?(o=1/(n-a),t[10]=(a+n)*o,t[14]=2*a*n*o):(t[10]=-1,t[14]=-2*n),t}function ke(t,e,r,n){var a=Math.tan(e.upDegrees*Math.PI/180),o=Math.tan(e.downDegrees*Math.PI/180),i=Math.tan(e.leftDegrees*Math.PI/180),s=Math.tan(e.rightDegrees*Math.PI/180),u=2/(i+s),c=2/(a+o);return t[0]=u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=-(i-s)*u*.5,t[9]=(a-o)*c*.5,t[10]=n/(r-n),t[11]=-1,t[12]=0,t[13]=0,t[14]=n*r/(r-n),t[15]=0,t}function Re(t,e,r,n,a,o,i){var s=1/(e-r),u=1/(n-a),c=1/(o-i);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+r)*s,t[13]=(a+n)*u,t[14]=(i+o)*c,t[15]=1,t}function Pe(t,e,r,n){var a,o,i,s,u,c,l,d,h,v,m=e[0],g=e[1],M=e[2],p=n[0],b=n[1],_=n[2],y=r[0],x=r[1],w=r[2];return Math.abs(m-y)<f&&Math.abs(g-x)<f&&Math.abs(M-w)<f?te(t):(l=m-y,d=g-x,h=M-w,a=b*(h*=v=1/Math.hypot(l,d,h))-_*(d*=v),o=_*(l*=v)-p*h,i=p*d-b*l,(v=Math.hypot(a,o,i))?(a*=v=1/v,o*=v,i*=v):(a=0,o=0,i=0),s=d*i-h*o,u=h*a-l*i,c=l*o-d*a,(v=Math.hypot(s,u,c))?(s*=v=1/v,u*=v,c*=v):(s=0,u=0,c=0),t[0]=a,t[1]=s,t[2]=l,t[3]=0,t[4]=o,t[5]=u,t[6]=d,t[7]=0,t[8]=i,t[9]=c,t[10]=h,t[11]=0,t[12]=-(a*m+o*g+i*M),t[13]=-(s*m+u*g+c*M),t[14]=-(l*m+d*g+h*M),t[15]=1,t)}function Fe(t,e,r,n){var a=e[0],o=e[1],i=e[2],s=n[0],u=n[1],c=n[2],l=a-r[0],d=o-r[1],h=i-r[2],f=l*l+d*d+h*h;f>0&&(l*=f=1/Math.sqrt(f),d*=f,h*=f);var v=u*h-c*d,m=c*l-s*h,g=s*d-u*l;return(f=v*v+m*m+g*g)>0&&(v*=f=1/Math.sqrt(f),m*=f,g*=f),t[0]=v,t[1]=m,t[2]=g,t[3]=0,t[4]=d*g-h*m,t[5]=h*v-l*g,t[6]=l*m-d*v,t[7]=0,t[8]=l,t[9]=d,t[10]=h,t[11]=0,t[12]=a,t[13]=o,t[14]=i,t[15]=1,t}function De(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function Ge(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}function Le(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t[9]=e[9]+r[9],t[10]=e[10]+r[10],t[11]=e[11]+r[11],t[12]=e[12]+r[12],t[13]=e[13]+r[13],t[14]=e[14]+r[14],t[15]=e[15]+r[15],t}function Ue(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t[9]=e[9]-r[9],t[10]=e[10]-r[10],t[11]=e[11]-r[11],t[12]=e[12]-r[12],t[13]=e[13]-r[13],t[14]=e[14]-r[14],t[15]=e[15]-r[15],t}function Ie(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t[9]=e[9]*r,t[10]=e[10]*r,t[11]=e[11]*r,t[12]=e[12]*r,t[13]=e[13]*r,t[14]=e[14]*r,t[15]=e[15]*r,t}function Ce(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t[6]=e[6]+r[6]*n,t[7]=e[7]+r[7]*n,t[8]=e[8]+r[8]*n,t[9]=e[9]+r[9]*n,t[10]=e[10]+r[10]*n,t[11]=e[11]+r[11]*n,t[12]=e[12]+r[12]*n,t[13]=e[13]+r[13]*n,t[14]=e[14]+r[14]*n,t[15]=e[15]+r[15]*n,t}function qe(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function Be(t,e){var r=t[0],n=t[1],a=t[2],o=t[3],i=t[4],s=t[5],u=t[6],c=t[7],l=t[8],d=t[9],h=t[10],v=t[11],m=t[12],g=t[13],M=t[14],p=t[15],b=e[0],_=e[1],y=e[2],x=e[3],w=e[4],A=e[5],E=e[6],S=e[7],T=e[8],k=e[9],R=e[10],P=e[11],F=e[12],D=e[13],G=e[14],L=e[15];return Math.abs(r-b)<=f*Math.max(1,Math.abs(r),Math.abs(b))&&Math.abs(n-_)<=f*Math.max(1,Math.abs(n),Math.abs(_))&&Math.abs(a-y)<=f*Math.max(1,Math.abs(a),Math.abs(y))&&Math.abs(o-x)<=f*Math.max(1,Math.abs(o),Math.abs(x))&&Math.abs(i-w)<=f*Math.max(1,Math.abs(i),Math.abs(w))&&Math.abs(s-A)<=f*Math.max(1,Math.abs(s),Math.abs(A))&&Math.abs(u-E)<=f*Math.max(1,Math.abs(u),Math.abs(E))&&Math.abs(c-S)<=f*Math.max(1,Math.abs(c),Math.abs(S))&&Math.abs(l-T)<=f*Math.max(1,Math.abs(l),Math.abs(T))&&Math.abs(d-k)<=f*Math.max(1,Math.abs(d),Math.abs(k))&&Math.abs(h-R)<=f*Math.max(1,Math.abs(h),Math.abs(R))&&Math.abs(v-P)<=f*Math.max(1,Math.abs(v),Math.abs(P))&&Math.abs(m-F)<=f*Math.max(1,Math.abs(m),Math.abs(F))&&Math.abs(g-D)<=f*Math.max(1,Math.abs(g),Math.abs(D))&&Math.abs(M-G)<=f*Math.max(1,Math.abs(M),Math.abs(G))&&Math.abs(p-L)<=f*Math.max(1,Math.abs(p),Math.abs(L))}var Ne=oe,Ve=Ue;function ze(){var t=new v(3);return v!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function Ye(t){var e=new v(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function Oe(t){var e=t[0],r=t[1],n=t[2];return Math.hypot(e,r,n)}function Qe(t,e,r){var n=new v(3);return n[0]=t,n[1]=e,n[2]=r,n}function Xe(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function He(t,e,r,n){return t[0]=e,t[1]=r,t[2]=n,t}function Ke(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t}function We(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t}function je(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t}function Ze(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t}function Je(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function $e(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function tr(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t}function er(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t}function rr(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function nr(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t}function ar(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t}function or(t,e){var r=e[0]-t[0],n=e[1]-t[1],a=e[2]-t[2];return Math.hypot(r,n,a)}function ir(t,e){var r=e[0]-t[0],n=e[1]-t[1],a=e[2]-t[2];return r*r+n*n+a*a}function sr(t){var e=t[0],r=t[1],n=t[2];return e*e+r*r+n*n}function ur(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function cr(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function lr(t,e){var r=e[0],n=e[1],a=e[2],o=r*r+n*n+a*a;return o>0&&(o=1/Math.sqrt(o)),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o,t}function dr(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function hr(t,e,r){var n=e[0],a=e[1],o=e[2],i=r[0],s=r[1],u=r[2];return t[0]=a*u-o*s,t[1]=o*i-n*u,t[2]=n*s-a*i,t}function fr(t,e,r,n){var a=e[0],o=e[1],i=e[2];return t[0]=a+n*(r[0]-a),t[1]=o+n*(r[1]-o),t[2]=i+n*(r[2]-i),t}function vr(t,e,r,n,a,o){var i=o*o,s=i*(2*o-3)+1,u=i*(o-2)+o,c=i*(o-1),l=i*(3-2*o);return t[0]=e[0]*s+r[0]*u+n[0]*c+a[0]*l,t[1]=e[1]*s+r[1]*u+n[1]*c+a[1]*l,t[2]=e[2]*s+r[2]*u+n[2]*c+a[2]*l,t}function mr(t,e,r,n,a,o){var i=1-o,s=i*i,u=o*o,c=s*i,l=3*o*s,d=3*u*i,h=u*o;return t[0]=e[0]*c+r[0]*l+n[0]*d+a[0]*h,t[1]=e[1]*c+r[1]*l+n[1]*d+a[1]*h,t[2]=e[2]*c+r[2]*l+n[2]*d+a[2]*h,t}function gr(t,e){e=e||1;var r=2*m()*Math.PI,n=2*m()-1,a=Math.sqrt(1-n*n)*e;return t[0]=Math.cos(r)*a,t[1]=Math.sin(r)*a,t[2]=n*e,t}function Mr(t,e,r){var n=e[0],a=e[1],o=e[2],i=r[3]*n+r[7]*a+r[11]*o+r[15];return i=i||1,t[0]=(r[0]*n+r[4]*a+r[8]*o+r[12])/i,t[1]=(r[1]*n+r[5]*a+r[9]*o+r[13])/i,t[2]=(r[2]*n+r[6]*a+r[10]*o+r[14])/i,t}function pr(t,e,r){var n=e[0],a=e[1],o=e[2];return t[0]=n*r[0]+a*r[3]+o*r[6],t[1]=n*r[1]+a*r[4]+o*r[7],t[2]=n*r[2]+a*r[5]+o*r[8],t}function br(t,e,r){var n=r[0],a=r[1],o=r[2],i=r[3],s=e[0],u=e[1],c=e[2],l=a*c-o*u,d=o*s-n*c,h=n*u-a*s,f=a*h-o*d,v=o*l-n*h,m=n*d-a*l,g=2*i;return l*=g,d*=g,h*=g,f*=2,v*=2,m*=2,t[0]=s+l+f,t[1]=u+d+v,t[2]=c+h+m,t}function _r(t,e,r,n){var a=[],o=[];return a[0]=e[0]-r[0],a[1]=e[1]-r[1],a[2]=e[2]-r[2],o[0]=a[0],o[1]=a[1]*Math.cos(n)-a[2]*Math.sin(n),o[2]=a[1]*Math.sin(n)+a[2]*Math.cos(n),t[0]=o[0]+r[0],t[1]=o[1]+r[1],t[2]=o[2]+r[2],t}function yr(t,e,r,n){var a=[],o=[];return a[0]=e[0]-r[0],a[1]=e[1]-r[1],a[2]=e[2]-r[2],o[0]=a[2]*Math.sin(n)+a[0]*Math.cos(n),o[1]=a[1],o[2]=a[2]*Math.cos(n)-a[0]*Math.sin(n),t[0]=o[0]+r[0],t[1]=o[1]+r[1],t[2]=o[2]+r[2],t}function xr(t,e,r,n){var a=[],o=[];return a[0]=e[0]-r[0],a[1]=e[1]-r[1],a[2]=e[2]-r[2],o[0]=a[0]*Math.cos(n)-a[1]*Math.sin(n),o[1]=a[0]*Math.sin(n)+a[1]*Math.cos(n),o[2]=a[2],t[0]=o[0]+r[0],t[1]=o[1]+r[1],t[2]=o[2]+r[2],t}function wr(t,e){var r=t[0],n=t[1],a=t[2],o=e[0],i=e[1],s=e[2],u=Math.sqrt(r*r+n*n+a*a)*Math.sqrt(o*o+i*i+s*s),c=u&&dr(t,e)/u;return Math.acos(Math.min(Math.max(c,-1),1))}function Ar(t){return t[0]=0,t[1]=0,t[2]=0,t}function Er(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function Sr(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function Tr(t,e){var r=t[0],n=t[1],a=t[2],o=e[0],i=e[1],s=e[2];return Math.abs(r-o)<=f*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(n-i)<=f*Math.max(1,Math.abs(n),Math.abs(i))&&Math.abs(a-s)<=f*Math.max(1,Math.abs(a),Math.abs(s))}var kr,Rr=We,Pr=je,Fr=Ze,Dr=or,Gr=ir,Lr=Oe,Ur=sr,Ir=(kr=ze(),function(t,e,r,n,a,o){var i,s;for(e||(e=3),r||(r=0),s=n?Math.min(n*e+r,t.length):t.length,i=r;i<s;i+=e)kr[0]=t[i],kr[1]=t[i+1],kr[2]=t[i+2],a(kr,kr,o),t[i]=kr[0],t[i+1]=kr[1],t[i+2]=kr[2];return t});function Cr(){var t=new v(4);return v!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function qr(t){var e=new v(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function Br(t,e,r,n){var a=new v(4);return a[0]=t,a[1]=e,a[2]=r,a[3]=n,a}function Nr(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function Vr(t,e,r,n,a){return t[0]=e,t[1]=r,t[2]=n,t[3]=a,t}function zr(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t}function Yr(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t}function Or(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t[3]=e[3]*r[3],t}function Qr(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t[3]=e[3]/r[3],t}function Xr(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t}function Hr(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t}function Kr(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t[3]=Math.min(e[3],r[3]),t}function Wr(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t[3]=Math.max(e[3],r[3]),t}function jr(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t}function Zr(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t}function Jr(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t}function $r(t,e){var r=e[0]-t[0],n=e[1]-t[1],a=e[2]-t[2],o=e[3]-t[3];return Math.hypot(r,n,a,o)}function tn(t,e){var r=e[0]-t[0],n=e[1]-t[1],a=e[2]-t[2],o=e[3]-t[3];return r*r+n*n+a*a+o*o}function en(t){var e=t[0],r=t[1],n=t[2],a=t[3];return Math.hypot(e,r,n,a)}function rn(t){var e=t[0],r=t[1],n=t[2],a=t[3];return e*e+r*r+n*n+a*a}function nn(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function an(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t}function on(t,e){var r=e[0],n=e[1],a=e[2],o=e[3],i=r*r+n*n+a*a+o*o;return i>0&&(i=1/Math.sqrt(i)),t[0]=r*i,t[1]=n*i,t[2]=a*i,t[3]=o*i,t}function sn(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function un(t,e,r,n){var a=r[0]*n[1]-r[1]*n[0],o=r[0]*n[2]-r[2]*n[0],i=r[0]*n[3]-r[3]*n[0],s=r[1]*n[2]-r[2]*n[1],u=r[1]*n[3]-r[3]*n[1],c=r[2]*n[3]-r[3]*n[2],l=e[0],d=e[1],h=e[2],f=e[3];return t[0]=d*c-h*u+f*s,t[1]=-l*c+h*i-f*o,t[2]=l*u-d*i+f*a,t[3]=-l*s+d*o-h*a,t}function cn(t,e,r,n){var a=e[0],o=e[1],i=e[2],s=e[3];return t[0]=a+n*(r[0]-a),t[1]=o+n*(r[1]-o),t[2]=i+n*(r[2]-i),t[3]=s+n*(r[3]-s),t}function ln(t,e){var r,n,a,o,i,s;e=e||1;do{i=(r=2*m()-1)*r+(n=2*m()-1)*n}while(i>=1);do{s=(a=2*m()-1)*a+(o=2*m()-1)*o}while(s>=1);var u=Math.sqrt((1-i)/s);return t[0]=e*r,t[1]=e*n,t[2]=e*a*u,t[3]=e*o*u,t}function dn(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3];return t[0]=r[0]*n+r[4]*a+r[8]*o+r[12]*i,t[1]=r[1]*n+r[5]*a+r[9]*o+r[13]*i,t[2]=r[2]*n+r[6]*a+r[10]*o+r[14]*i,t[3]=r[3]*n+r[7]*a+r[11]*o+r[15]*i,t}function hn(t,e,r){var n=e[0],a=e[1],o=e[2],i=r[0],s=r[1],u=r[2],c=r[3],l=c*n+s*o-u*a,d=c*a+u*n-i*o,h=c*o+i*a-s*n,f=-i*n-s*a-u*o;return t[0]=l*c+f*-i+d*-u-h*-s,t[1]=d*c+f*-s+h*-i-l*-u,t[2]=h*c+f*-u+l*-s-d*-i,t[3]=e[3],t}function fn(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}function vn(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function mn(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function gn(t,e){var r=t[0],n=t[1],a=t[2],o=t[3],i=e[0],s=e[1],u=e[2],c=e[3];return Math.abs(r-i)<=f*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(n-s)<=f*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(a-u)<=f*Math.max(1,Math.abs(a),Math.abs(u))&&Math.abs(o-c)<=f*Math.max(1,Math.abs(o),Math.abs(c))}var Mn=Yr,pn=Or,bn=Qr,_n=$r,yn=tn,xn=en,wn=rn,An=function(){var t=Cr();return function(e,r,n,a,o,i){var s,u;for(r||(r=4),n||(n=0),u=a?Math.min(a*r+n,e.length):e.length,s=n;s<u;s+=r)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],t[3]=e[s+3],o(t,t,i),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2],e[s+3]=t[3];return e}}();function En(){var t=new v(4);return v!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function Sn(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function Tn(t,e,r){r*=.5;var n=Math.sin(r);return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=Math.cos(r),t}function kn(t,e){var r=2*Math.acos(e[3]),n=Math.sin(r/2);return n>f?(t[0]=e[0]/n,t[1]=e[1]/n,t[2]=e[2]/n):(t[0]=1,t[1]=0,t[2]=0),r}function Rn(t,e){var r=aa(t,e);return Math.acos(2*r*r-1)}function Pn(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],s=r[0],u=r[1],c=r[2],l=r[3];return t[0]=n*l+i*s+a*c-o*u,t[1]=a*l+i*u+o*s-n*c,t[2]=o*l+i*c+n*u-a*s,t[3]=i*l-n*s-a*u-o*c,t}function Fn(t,e,r){r*=.5;var n=e[0],a=e[1],o=e[2],i=e[3],s=Math.sin(r),u=Math.cos(r);return t[0]=n*u+i*s,t[1]=a*u+o*s,t[2]=o*u-a*s,t[3]=i*u-n*s,t}function Dn(t,e,r){r*=.5;var n=e[0],a=e[1],o=e[2],i=e[3],s=Math.sin(r),u=Math.cos(r);return t[0]=n*u-o*s,t[1]=a*u+i*s,t[2]=o*u+n*s,t[3]=i*u-a*s,t}function Gn(t,e,r){r*=.5;var n=e[0],a=e[1],o=e[2],i=e[3],s=Math.sin(r),u=Math.cos(r);return t[0]=n*u+a*s,t[1]=a*u-n*s,t[2]=o*u+i*s,t[3]=i*u-o*s,t}function Ln(t,e){var r=e[0],n=e[1],a=e[2];return t[0]=r,t[1]=n,t[2]=a,t[3]=Math.sqrt(Math.abs(1-r*r-n*n-a*a)),t}function Un(t,e){var r=e[0],n=e[1],a=e[2],o=e[3],i=Math.sqrt(r*r+n*n+a*a),s=Math.exp(o),u=i>0?s*Math.sin(i)/i:0;return t[0]=r*u,t[1]=n*u,t[2]=a*u,t[3]=s*Math.cos(i),t}function In(t,e){var r=e[0],n=e[1],a=e[2],o=e[3],i=Math.sqrt(r*r+n*n+a*a),s=i>0?Math.atan2(i,o)/i:0;return t[0]=r*s,t[1]=n*s,t[2]=a*s,t[3]=.5*Math.log(r*r+n*n+a*a+o*o),t}function Cn(t,e,r){return In(t,e),na(t,t,r),Un(t,t),t}function qn(t,e,r,n){var a,o,i,s,u,c=e[0],l=e[1],d=e[2],h=e[3],v=r[0],m=r[1],g=r[2],M=r[3];return(o=c*v+l*m+d*g+h*M)<0&&(o=-o,v=-v,m=-m,g=-g,M=-M),1-o>f?(a=Math.acos(o),i=Math.sin(a),s=Math.sin((1-n)*a)/i,u=Math.sin(n*a)/i):(s=1-n,u=n),t[0]=s*c+u*v,t[1]=s*l+u*m,t[2]=s*d+u*g,t[3]=s*h+u*M,t}function Bn(t){var e=m(),r=m(),n=m(),a=Math.sqrt(1-e),o=Math.sqrt(e);return t[0]=a*Math.sin(2*Math.PI*r),t[1]=a*Math.cos(2*Math.PI*r),t[2]=o*Math.sin(2*Math.PI*n),t[3]=o*Math.cos(2*Math.PI*n),t}function Nn(t,e){var r=e[0],n=e[1],a=e[2],o=e[3],i=r*r+n*n+a*a+o*o,s=i?1/i:0;return t[0]=-r*s,t[1]=-n*s,t[2]=-a*s,t[3]=o*s,t}function Vn(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function zn(t,e){var r,n=e[0]+e[4]+e[8];if(n>0)r=Math.sqrt(n+1),t[3]=.5*r,r=.5/r,t[0]=(e[5]-e[7])*r,t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{var a=0;e[4]>e[0]&&(a=1),e[8]>e[3*a+a]&&(a=2);var o=(a+1)%3,i=(a+2)%3;r=Math.sqrt(e[3*a+a]-e[3*o+o]-e[3*i+i]+1),t[a]=.5*r,r=.5/r,t[3]=(e[3*o+i]-e[3*i+o])*r,t[o]=(e[3*o+a]+e[3*a+o])*r,t[i]=(e[3*i+a]+e[3*a+i])*r}return t}function Yn(t,e,r,n){var a=.5*Math.PI/180;e*=a,r*=a,n*=a;var o=Math.sin(e),i=Math.cos(e),s=Math.sin(r),u=Math.cos(r),c=Math.sin(n),l=Math.cos(n);return t[0]=o*u*l-i*s*c,t[1]=i*s*l+o*u*c,t[2]=i*u*c-o*s*l,t[3]=i*u*l+o*s*c,t}function On(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}var Qn,Xn,Hn,Kn,Wn,jn,Zn=qr,Jn=Br,$n=Nr,ta=Vr,ea=zr,ra=Pn,na=Zr,aa=sn,oa=cn,ia=en,sa=ia,ua=rn,ca=ua,la=on,da=mn,ha=gn,fa=(Qn=ze(),Xn=Qe(1,0,0),Hn=Qe(0,1,0),function(t,e,r){var n=dr(e,r);return n<-.999999?(hr(Qn,Xn,e),Lr(Qn)<1e-6&&hr(Qn,Hn,e),lr(Qn,Qn),Tn(t,Qn,Math.PI),t):n>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(hr(Qn,e,r),t[0]=Qn[0],t[1]=Qn[1],t[2]=Qn[2],t[3]=1+n,la(t,t))}),va=(Kn=En(),Wn=En(),function(t,e,r,n,a,o){return qn(Kn,e,a,o),qn(Wn,r,n,o),qn(t,Kn,Wn,2*o*(1-o)),t}),ma=(jn=Mt(),function(t,e,r,n){return jn[0]=r[0],jn[3]=r[1],jn[6]=r[2],jn[1]=n[0],jn[4]=n[1],jn[7]=n[2],jn[2]=-e[0],jn[5]=-e[1],jn[8]=-e[2],la(t,zn(t,jn))});function ga(){var t=new v(8);return v!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[4]=0,t[5]=0,t[6]=0,t[7]=0),t[3]=1,t}function Ma(t){var e=new v(8);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e}function pa(t,e,r,n,a,o,i,s){var u=new v(8);return u[0]=t,u[1]=e,u[2]=r,u[3]=n,u[4]=a,u[5]=o,u[6]=i,u[7]=s,u}function ba(t,e,r,n,a,o,i){var s=new v(8);s[0]=t,s[1]=e,s[2]=r,s[3]=n;var u=.5*a,c=.5*o,l=.5*i;return s[4]=u*n+c*r-l*e,s[5]=c*n+l*t-u*r,s[6]=l*n+u*e-c*t,s[7]=-u*t-c*e-l*r,s}function _a(t,e,r){var n=.5*r[0],a=.5*r[1],o=.5*r[2],i=e[0],s=e[1],u=e[2],c=e[3];return t[0]=i,t[1]=s,t[2]=u,t[3]=c,t[4]=n*c+a*u-o*s,t[5]=a*c+o*i-n*u,t[6]=o*c+n*s-a*i,t[7]=-n*i-a*s-o*u,t}function ya(t,e){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=.5*e[0],t[5]=.5*e[1],t[6]=.5*e[2],t[7]=0,t}function xa(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=0,t[5]=0,t[6]=0,t[7]=0,t}function wa(t,e){var r=En();xe(r,e);var n=new v(3);return _e(n,e),_a(t,r,n),t}function Aa(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t}function Ea(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t}function Sa(t,e,r,n,a,o,i,s,u){return t[0]=e,t[1]=r,t[2]=n,t[3]=a,t[4]=o,t[5]=i,t[6]=s,t[7]=u,t}var Ta=$n;function ka(t,e){return t[0]=e[4],t[1]=e[5],t[2]=e[6],t[3]=e[7],t}var Ra=$n;function Pa(t,e){return t[4]=e[0],t[5]=e[1],t[6]=e[2],t[7]=e[3],t}function Fa(t,e){var r=e[4],n=e[5],a=e[6],o=e[7],i=-e[0],s=-e[1],u=-e[2],c=e[3];return t[0]=2*(r*c+o*i+n*u-a*s),t[1]=2*(n*c+o*s+a*i-r*u),t[2]=2*(a*c+o*u+r*s-n*i),t}function Da(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],s=.5*r[0],u=.5*r[1],c=.5*r[2],l=e[4],d=e[5],h=e[6],f=e[7];return t[0]=n,t[1]=a,t[2]=o,t[3]=i,t[4]=i*s+a*c-o*u+l,t[5]=i*u+o*s-n*c+d,t[6]=i*c+n*u-a*s+h,t[7]=-n*s-a*u-o*c+f,t}function Ga(t,e,r){var n=-e[0],a=-e[1],o=-e[2],i=e[3],s=e[4],u=e[5],c=e[6],l=e[7],d=s*i+l*n+u*o-c*a,h=u*i+l*a+c*n-s*o,f=c*i+l*o+s*a-u*n,v=l*i-s*n-u*a-c*o;return Fn(t,e,r),n=t[0],a=t[1],o=t[2],i=t[3],t[4]=d*i+v*n+h*o-f*a,t[5]=h*i+v*a+f*n-d*o,t[6]=f*i+v*o+d*a-h*n,t[7]=v*i-d*n-h*a-f*o,t}function La(t,e,r){var n=-e[0],a=-e[1],o=-e[2],i=e[3],s=e[4],u=e[5],c=e[6],l=e[7],d=s*i+l*n+u*o-c*a,h=u*i+l*a+c*n-s*o,f=c*i+l*o+s*a-u*n,v=l*i-s*n-u*a-c*o;return Dn(t,e,r),n=t[0],a=t[1],o=t[2],i=t[3],t[4]=d*i+v*n+h*o-f*a,t[5]=h*i+v*a+f*n-d*o,t[6]=f*i+v*o+d*a-h*n,t[7]=v*i-d*n-h*a-f*o,t}function Ua(t,e,r){var n=-e[0],a=-e[1],o=-e[2],i=e[3],s=e[4],u=e[5],c=e[6],l=e[7],d=s*i+l*n+u*o-c*a,h=u*i+l*a+c*n-s*o,f=c*i+l*o+s*a-u*n,v=l*i-s*n-u*a-c*o;return Gn(t,e,r),n=t[0],a=t[1],o=t[2],i=t[3],t[4]=d*i+v*n+h*o-f*a,t[5]=h*i+v*a+f*n-d*o,t[6]=f*i+v*o+d*a-h*n,t[7]=v*i-d*n-h*a-f*o,t}function Ia(t,e,r){var n=r[0],a=r[1],o=r[2],i=r[3],s=e[0],u=e[1],c=e[2],l=e[3];return t[0]=s*i+l*n+u*o-c*a,t[1]=u*i+l*a+c*n-s*o,t[2]=c*i+l*o+s*a-u*n,t[3]=l*i-s*n-u*a-c*o,s=e[4],u=e[5],c=e[6],l=e[7],t[4]=s*i+l*n+u*o-c*a,t[5]=u*i+l*a+c*n-s*o,t[6]=c*i+l*o+s*a-u*n,t[7]=l*i-s*n-u*a-c*o,t}function Ca(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],s=r[0],u=r[1],c=r[2],l=r[3];return t[0]=n*l+i*s+a*c-o*u,t[1]=a*l+i*u+o*s-n*c,t[2]=o*l+i*c+n*u-a*s,t[3]=i*l-n*s-a*u-o*c,s=r[4],u=r[5],c=r[6],l=r[7],t[4]=n*l+i*s+a*c-o*u,t[5]=a*l+i*u+o*s-n*c,t[6]=o*l+i*c+n*u-a*s,t[7]=i*l-n*s-a*u-o*c,t}function qa(t,e,r,n){if(Math.abs(n)<f)return Aa(t,e);var a=Math.hypot(r[0],r[1],r[2]);n*=.5;var o=Math.sin(n),i=o*r[0]/a,s=o*r[1]/a,u=o*r[2]/a,c=Math.cos(n),l=e[0],d=e[1],h=e[2],v=e[3];t[0]=l*c+v*i+d*u-h*s,t[1]=d*c+v*s+h*i-l*u,t[2]=h*c+v*u+l*s-d*i,t[3]=v*c-l*i-d*s-h*u;var m=e[4],g=e[5],M=e[6],p=e[7];return t[4]=m*c+p*i+g*u-M*s,t[5]=g*c+p*s+M*i-m*u,t[6]=M*c+p*u+m*s-g*i,t[7]=p*c-m*i-g*s-M*u,t}function Ba(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t}function Na(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],s=r[4],u=r[5],c=r[6],l=r[7],d=e[4],h=e[5],f=e[6],v=e[7],m=r[0],g=r[1],M=r[2],p=r[3];return t[0]=n*p+i*m+a*M-o*g,t[1]=a*p+i*g+o*m-n*M,t[2]=o*p+i*M+n*g-a*m,t[3]=i*p-n*m-a*g-o*M,t[4]=n*l+i*s+a*c-o*u+d*p+v*m+h*M-f*g,t[5]=a*l+i*u+o*s-n*c+h*p+v*g+f*m-d*M,t[6]=o*l+i*c+n*u-a*s+f*p+v*M+d*g-h*m,t[7]=i*l-n*s-a*u-o*c+v*p-d*m-h*g-f*M,t}var Va=Na;function za(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t}var Ya=aa;function Oa(t,e,r,n){var a=1-n;return Ya(e,r)<0&&(n=-n),t[0]=e[0]*a+r[0]*n,t[1]=e[1]*a+r[1]*n,t[2]=e[2]*a+r[2]*n,t[3]=e[3]*a+r[3]*n,t[4]=e[4]*a+r[4]*n,t[5]=e[5]*a+r[5]*n,t[6]=e[6]*a+r[6]*n,t[7]=e[7]*a+r[7]*n,t}function Qa(t,e){var r=Wa(e);return t[0]=-e[0]/r,t[1]=-e[1]/r,t[2]=-e[2]/r,t[3]=e[3]/r,t[4]=-e[4]/r,t[5]=-e[5]/r,t[6]=-e[6]/r,t[7]=e[7]/r,t}function Xa(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=e[7],t}var Ha=ia,Ka=Ha,Wa=ua,ja=Wa;function Za(t,e){var r=Wa(e);if(r>0){r=Math.sqrt(r);var n=e[0]/r,a=e[1]/r,o=e[2]/r,i=e[3]/r,s=e[4],u=e[5],c=e[6],l=e[7],d=n*s+a*u+o*c+i*l;t[0]=n,t[1]=a,t[2]=o,t[3]=i,t[4]=(s-n*d)/r,t[5]=(u-a*d)/r,t[6]=(c-o*d)/r,t[7]=(l-i*d)/r}return t}function Ja(t){return"quat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+")"}function $a(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]}function to(t,e){var r=t[0],n=t[1],a=t[2],o=t[3],i=t[4],s=t[5],u=t[6],c=t[7],l=e[0],d=e[1],h=e[2],v=e[3],m=e[4],g=e[5],M=e[6],p=e[7];return Math.abs(r-l)<=f*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(n-d)<=f*Math.max(1,Math.abs(n),Math.abs(d))&&Math.abs(a-h)<=f*Math.max(1,Math.abs(a),Math.abs(h))&&Math.abs(o-v)<=f*Math.max(1,Math.abs(o),Math.abs(v))&&Math.abs(i-m)<=f*Math.max(1,Math.abs(i),Math.abs(m))&&Math.abs(s-g)<=f*Math.max(1,Math.abs(s),Math.abs(g))&&Math.abs(u-M)<=f*Math.max(1,Math.abs(u),Math.abs(M))&&Math.abs(c-p)<=f*Math.max(1,Math.abs(c),Math.abs(p))}function eo(){var t=new v(2);return v!=Float32Array&&(t[0]=0,t[1]=0),t}function ro(t){var e=new v(2);return e[0]=t[0],e[1]=t[1],e}function no(t,e){var r=new v(2);return r[0]=t,r[1]=e,r}function ao(t,e){return t[0]=e[0],t[1]=e[1],t}function oo(t,e,r){return t[0]=e,t[1]=r,t}function io(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t}function so(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t}function uo(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t}function co(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t}function lo(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t}function ho(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t}function fo(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t}function vo(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t}function mo(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t}function go(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t}function Mo(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t}function po(t,e){var r=e[0]-t[0],n=e[1]-t[1];return Math.hypot(r,n)}function bo(t,e){var r=e[0]-t[0],n=e[1]-t[1];return r*r+n*n}function _o(t){var e=t[0],r=t[1];return Math.hypot(e,r)}function yo(t){var e=t[0],r=t[1];return e*e+r*r}function xo(t,e){return t[0]=-e[0],t[1]=-e[1],t}function wo(t,e){return t[0]=1/e[0],t[1]=1/e[1],t}function Ao(t,e){var r=e[0],n=e[1],a=r*r+n*n;return a>0&&(a=1/Math.sqrt(a)),t[0]=e[0]*a,t[1]=e[1]*a,t}function Eo(t,e){return t[0]*e[0]+t[1]*e[1]}function So(t,e,r){var n=e[0]*r[1]-e[1]*r[0];return t[0]=t[1]=0,t[2]=n,t}function To(t,e,r,n){var a=e[0],o=e[1];return t[0]=a+n*(r[0]-a),t[1]=o+n*(r[1]-o),t}function ko(t,e){e=e||1;var r=2*m()*Math.PI;return t[0]=Math.cos(r)*e,t[1]=Math.sin(r)*e,t}function Ro(t,e,r){var n=e[0],a=e[1];return t[0]=r[0]*n+r[2]*a,t[1]=r[1]*n+r[3]*a,t}function Po(t,e,r){var n=e[0],a=e[1];return t[0]=r[0]*n+r[2]*a+r[4],t[1]=r[1]*n+r[3]*a+r[5],t}function Fo(t,e,r){var n=e[0],a=e[1];return t[0]=r[0]*n+r[3]*a+r[6],t[1]=r[1]*n+r[4]*a+r[7],t}function Do(t,e,r){var n=e[0],a=e[1];return t[0]=r[0]*n+r[4]*a+r[12],t[1]=r[1]*n+r[5]*a+r[13],t}function Go(t,e,r,n){var a=e[0]-r[0],o=e[1]-r[1],i=Math.sin(n),s=Math.cos(n);return t[0]=a*s-o*i+r[0],t[1]=a*i+o*s+r[1],t}function Lo(t,e){var r=t[0],n=t[1],a=e[0],o=e[1],i=Math.sqrt(r*r+n*n)*Math.sqrt(a*a+o*o),s=i&&(r*a+n*o)/i;return Math.acos(Math.min(Math.max(s,-1),1))}function Uo(t){return t[0]=0,t[1]=0,t}function Io(t){return"vec2("+t[0]+", "+t[1]+")"}function Co(t,e){return t[0]===e[0]&&t[1]===e[1]}function qo(t,e){var r=t[0],n=t[1],a=e[0],o=e[1];return Math.abs(r-a)<=f*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(n-o)<=f*Math.max(1,Math.abs(n),Math.abs(o))}var Bo=_o,No=so,Vo=uo,zo=co,Yo=po,Oo=bo,Qo=yo,Xo=function(){var t=eo();return function(e,r,n,a,o,i){var s,u;for(r||(r=2),n||(n=0),u=a?Math.min(a*r+n,e.length):e.length,s=n;s<u;s+=r)t[0]=e[s],t[1]=e[s+1],o(t,t,i),e[s]=t[0],e[s+1]=t[1];return e}}()},985:(t,e,r)=>{r.r(e)},195:(t,e,r)=>{r.r(e),r.d(e,{default:()=>n});const n="#version 300 es\n#define GLSLIFY 1\n\nout highp vec4 FragColor;\n\nin highp vec2 uv;\n\nuniform highp float time;\nuniform sampler2D tex;\n\nvoid main()\n{\n    FragColor = texture(tex, uv * 0.125);\n    FragColor.a = sin(time * 12.0) * 0.025 + 0.2;\n}"},895:(t,e,r)=>{r.r(e),r.d(e,{default:()=>n});const n="#version 300 es\n#define GLSLIFY 1\n\nlayout (location = 0) in vec3 aPos;\nlayout (location = 1) in vec2 aUv;\nlayout (location = 2) in float faceNum;\n\nuniform mat4 mvp;\nuniform vec3 cursorPos;\nuniform float cursorSize;\nuniform float renderFaces[6];\n\nout highp vec2 uv;\n\nvoid main()\n{\n    gl_Position = mvp * vec4((aPos - 0.5) * cursorSize + 0.5 + cursorPos, 1.0);\n    uv = aUv;\n\n    float shouldShowFace = renderFaces[int(faceNum)];\n    gl_Position *= shouldShowFace;\n}\n"},0:(t,e,r)=>{r.r(e),r.d(e,{default:()=>n});const n="#version 300 es\n// Special texture sampling algorithm that avoids texture-atlas artifacts by\n// avoiding sampling UVs that are closer than 0.5 pixels to the edge\n\nprecision highp float;\n\nvec4 texSample(sampler2D s, vec2 uv)\n{\n    vec2 localUv = uv - floor(uv);\n    vec2 intUv = floor(uv);\n\n    // This represents the size in pixels of each individual block texture in the atlas\n    // Change this if we ever resize the textures!!!\n    float CELL_SIZE = 8.0;\n\n    float clampTo = 0.5 / CELL_SIZE;\n    localUv = clamp(localUv, clampTo, 1.0 - clampTo);\n\n    vec4 col = texture(s, (localUv + intUv) * 0.125);\n\n    // TODO Render transparent blocks in another pass to reduce discards\n    if (col.a < 0.1) discard;\n    return col;\n}\n\nprecision highp float;\n#define GLSLIFY 1\n\nin vec2 uv;\nin float power;\n\nuniform float alpha;\nuniform sampler2D tex;\n\nout vec4 FragColor;\n\nvoid main()\n{\n    FragColor = texSample(tex, uv);\n    FragColor.rgb *= power;\n    FragColor.a *= alpha;\n}\n"},364:(t,e,r)=>{r.r(e),r.d(e,{default:()=>n});const n="#version 300 es\n#define GLSLIFY 1\nlayout (location = 0) in vec3 aPos;\nlayout (location = 1) in vec2 aUv;\nlayout (location = 2) in float aPower;\n\nuniform mat4 mvp;\n\nout vec2 uv;\nout float power;\n\nvoid main()\n{\n    gl_Position = mvp * vec4(aPos, 1.0);\n    uv = aUv;\n    power = aPower;\n}\n"},353:(t,e,r)=>{r.r(e),r.d(e,{default:()=>n});const n="#version 300 es\n\nprecision lowp float;\n#define GLSLIFY 1\n\nout vec4 FragColor;\n\nuniform highp vec4 uiPosition;\nuniform highp vec4 cellParameters;\nuniform highp float selectTime;\n\nvoid main()\n{\n    float u_left = uiPosition.x;\n    float u_bottom = uiPosition.y;\n    float u_width = uiPosition.z;\n    float u_height = uiPosition.w;\n\n    float u_cellSize = cellParameters.x;\n    float u_cellSpacing = cellParameters.y;\n    float u_padding = cellParameters.z;\n    float u_selectedIndex = cellParameters.w;\n\n    float s = u_cellSize+u_cellSpacing;\n\n    float ncells = floor( (u_width - 2.0*u_padding + u_cellSpacing)/s );\n\n    vec2 off = gl_FragCoord.xy - vec2(u_left,u_bottom) - vec2(u_padding);\n    float cellIndex = floor( off.x/s );\n    // This variable is unused for now, but could be useful for reference\n    bool inCell = (cellIndex >= 0.0 && off.x-cellIndex*s < u_cellSize &&\n        cellIndex < ncells &&\n        off.y >= 0.0 && off.y <= u_cellSize);\n\n    vec4 col_yellow = vec4(0.90, 0.82, 0.20, 1.0);\n    vec4 col_blue   = vec4(0.20, 0.73, 0.90, 1.0);\n\n    // Usually a nice yellow color, but change to a blue color behind a selected object\n    float bgTransition = clamp(selectTime*6.0, 0.0, 1.0);\n    FragColor = mix(col_yellow, col_blue, float(\n        abs(u_selectedIndex-cellIndex) < 0.01 &&    // u_selectedCellIndex == (the cellIndex of this pixel)\n        off.x-cellIndex*s < u_cellSize &&           // pixel is not in the padding region of the cell\n        abs(off.y - u_cellSize*0.5) < u_height*bgTransition\n        ));\n}\n"},845:(t,e,r)=>{r.r(e),r.d(e,{default:()=>n});const n="#version 300 es\n\nprecision highp float;\n#define GLSLIFY 1\n\nlayout (location = 0) in vec3 aPos;\n\nuniform vec2 screenDimensions;\nuniform vec4 uiPosition;\n\nvoid main()\n{\n    vec2 offsetXY = uiPosition.xy / screenDimensions;\n    vec2 scaleXY = uiPosition.zw / screenDimensions;\n    vec2 xy = offsetXY + aPos.xy*scaleXY;\n    gl_Position = vec4(2.0*xy - 1.0, 0.0, 1.0);\n}\n"},275:(t,e,r)=>{r.r(e),r.d(e,{default:()=>n});const n="#version 300 es\n// Special texture sampling algorithm that avoids texture-atlas artifacts by\n// avoiding sampling UVs that are closer than 0.5 pixels to the edge\n\nprecision highp float;\n\nvec4 texSample(sampler2D s, vec2 uv)\n{\n    vec2 localUv = uv - floor(uv);\n    vec2 intUv = floor(uv);\n\n    // This represents the size in pixels of each individual block texture in the atlas\n    // Change this if we ever resize the textures!!!\n    float CELL_SIZE = 8.0;\n\n    float clampTo = 0.5 / CELL_SIZE;\n    localUv = clamp(localUv, clampTo, 1.0 - clampTo);\n\n    vec4 col = texture(s, (localUv + intUv) * 0.125);\n\n    // TODO Render transparent blocks in another pass to reduce discards\n    if (col.a < 0.1) discard;\n    return col;\n}\n\nprecision highp float;\n#define GLSLIFY 1\n\nout highp vec4 FragColor;\n\nin highp vec2 uv;\n\nuniform highp float alpha;\nuniform sampler2D tex;\n\nvoid main()\n{\n    FragColor = texSample(tex, uv);\n    FragColor.a *= alpha;\n}\n"},366:(t,e,r)=>{r.r(e),r.d(e,{default:()=>n});const n="#version 300 es\n#define GLSLIFY 1\nlayout (location = 0) in vec3 aPos;\nlayout (location = 1) in vec2 aUv;\n\nuniform mat4 mvp;\n\nout vec2 uv;\n\nvoid main()\n{\n    gl_Position = mvp * vec4(aPos, 1.0);\n    uv = aUv;\n}"},39:function(t,e,r){var n=this&&this.__spreadArrays||function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),a=0;for(e=0;e<r;e++)for(var o=arguments[e],i=0,s=o.length;i<s;i++,a++)n[a]=o[i];return n};e.__esModule=!0,e.blocks=void 0;var a=r(887),o=r(462),i=r(287),s=r(393),u=r(120),c=r(634),l=r(116),d=r(111),h=Math.abs,f=(Math.min,Math.max),v=function(t){return function(e,r,n,a){a.queueBlockUpdate().set(r,t)}},m=0,g=function(){function t(){}return t.prototype.init=function(){this.vao=gl.createVertexArray(),this.vbo=gl.createBuffer(),this.ebo=gl.createBuffer();var t=u.initShader("test_vert",testVertSrc,gl.VERTEX_SHADER),e=u.initShader("test_frag",testFragSrc,gl.FRAGMENT_SHADER);this.program=u.initProgram(t,e),this.loc_mvp=gl.getUniformLocation(this.program,"mvp"),this.loc_alpha=gl.getUniformLocation(this.program,"alpha"),gl.bindVertexArray(this.vao),gl.bindBuffer(gl.ARRAY_BUFFER,this.vbo),gl.vertexAttribPointer(0,3,gl.FLOAT,!1,20,0),gl.vertexAttribPointer(1,2,gl.FLOAT,!1,20,12),gl.enableVertexAttribArray(0),gl.enableVertexAttribArray(1)},t.prototype.uploadCombinedModel=function(t){gl.bindVertexArray(this.vao),gl.bindBuffer(gl.ARRAY_BUFFER,this.vbo),gl.bufferData(gl.ARRAY_BUFFER,t.vertexData,gl.STATIC_DRAW),gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,this.ebo),gl.bufferData(gl.ELEMENT_ARRAY_BUFFER,t.indices,gl.STATIC_DRAW),this.nElements=t.indices.length},t.prototype.renderCombinedModel=function(t,e){gl.bindVertexArray(this.vao),gl.useProgram(this.program),gl.uniformMatrix4fv(this.loc_mvp,!1,t.mvp),gl.uniform1f(this.loc_alpha,e),gl.drawElements(gl.TRIANGLES,this.nElements,gl.UNSIGNED_INT,0)},t}();c.materialRegistry.add("default",(function(){return new g}));var M=function(){function t(){}return t.prototype.init=function(){this.vao=gl.createVertexArray(),this.vbo=gl.createBuffer(),this.ebo=gl.createBuffer();var t=u.initShader("dust_vert",dustVertSrc,gl.VERTEX_SHADER),e=u.initShader("dust_frag",dustFragSrc,gl.FRAGMENT_SHADER);this.program=u.initProgram(t,e),this.loc_mvp=gl.getUniformLocation(this.program,"mvp"),this.loc_alpha=gl.getUniformLocation(this.program,"alpha"),gl.bindVertexArray(this.vao),gl.bindBuffer(gl.ARRAY_BUFFER,this.vbo),gl.vertexAttribPointer(0,3,gl.FLOAT,!1,24,0),gl.vertexAttribPointer(1,2,gl.FLOAT,!1,24,12),gl.vertexAttribPointer(2,1,gl.FLOAT,!1,24,20),gl.enableVertexAttribArray(0),gl.enableVertexAttribArray(1),gl.enableVertexAttribArray(2)},t.prototype.uploadCombinedModel=function(t){gl.bindVertexArray(this.vao),gl.bindBuffer(gl.ARRAY_BUFFER,this.vbo),gl.bufferData(gl.ARRAY_BUFFER,t.vertexData,gl.STATIC_DRAW),gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,this.ebo),gl.bufferData(gl.ELEMENT_ARRAY_BUFFER,t.indices,gl.STATIC_DRAW),this.nElements=t.indices.length},t.prototype.renderCombinedModel=function(t,e){gl.bindVertexArray(this.vao),gl.useProgram(this.program),gl.uniformMatrix4fv(this.loc_mvp,!1,t.mvp),gl.uniform1f(this.loc_alpha,e),gl.drawElements(gl.TRIANGLES,this.nElements,gl.UNSIGNED_INT,0)},t}();c.materialRegistry.add("dust",(function(){return new M}));for(var p={materialName:"default",nModels:1,render:function(t,e,r,n,o){var u=a.mat4.create();a.mat4.translate(u,u,e);for(var c=[],l=0;l<6;l++)s.useUvs(0,c,8*l);var d=i.Model.use(i.models.texturedCube,{nPerVertex:2,data:c},u);s.ModelCombiner.addModel(o,d)}},b={materialName:"dust",nModels:1,render:function(t,e,r,n,o){for(var u,c,l=0,d=4;d<=7;d++)n&1<<d&&l++;var h=!!(128&n),f=!!(64&n),v=!!(32&n),m=!!(16&n);0===l?u=4096&n?6:2:1===l?u=f||h?3:7:2===l?h&&f?u=3:v&&m?(u=3,c=90):(u=4,m&&h?c=90:m&&f?c=180:v&&f&&(c=270)):3===l?(u=5,f?v?h||(c=270):c=180:c=90):u=2;var g=!!(2048&n),M=!!(1024&n),p=!!(512&n),b=!!(256&n),_=a.mat4.create();a.mat4.translate(_,_,e),a.mat4.translate(_,_,[.005,.05,.005]),a.mat4.scale(_,_,[.99,.95,.99]);for(var y=[],x=0;x<6;x++){var w=64;5===x?w=u:(1===x&&g||2===x&&M||3===x&&p||4===x&&b)&&(w=7);var A=5===x?c:0;s.useUvs(w,y,12*x,A,3)}var E=15&n,S=E?E/15*.7+.3:.1;for(x=0;x<24;x++)y[3*x+2]=S;var T=i.Model.use(i.models.texturedCube,{nPerVertex:3,data:y},_,!0);s.ModelCombiner.addModel(o,T)}},_={materialName:"default",nModels:1,render:function(t,e,r,n,o){var u=a.mat4.create();a.mat4.translate(u,u,e),a.mat4.translate(u,u,[0,.5,0]),a.mat4.scale(u,u,[1,.5,1]);for(var c=[],l=0;l<6;l++)s.useUvs(0,c,8*l);var d=i.Model.use(i.models.texturedCube,{nPerVertex:2,data:c},u);s.ModelCombiner.addModel(o,d)}},y={materialName:"default",nModels:1,render:function(t,r,n,o,u){var c=a.mat4.create();a.mat4.translate(c,c,r);var l=e.blocks.torch.getMountedDirection(o);if(l!==d.default.down){var h;h=l===d.default.west?0:l===d.default.east?180:l===d.default.north?270:90;var f=[.5,.5,.5];a.mat4.translate(c,c,f),a.mat4.rotateY(c,c,.0174532925*h),a.mat4.translate(c,c,[-.3,0,0]),a.mat4.rotateZ(c,c,-.479965544),a.mat4.rotateY(c,c,-.0174532925*h),a.vec3.negate(f,f),a.mat4.translate(c,c,f)}for(var v=[],m=e.blocks.torch.isEnabled(o),g=m?8:11,M=m?9:12,p=0;p<6;p++){var b=g;0===p?b=M:5===p&&(b=10),s.useUvs(b,v,8*p)}var _=i.Model.use(i.models.torch,{nPerVertex:2,data:v},c);s.ModelCombiner.addModel(u,_)}},x=[],w=[],A=-2;A<=2;A++)for(var E=-2;E<=2;E++)for(var S=-2;S<=2;S++){var T=h(A)+h(E)+h(S);if(0!==T){var k=a.vec3.fromValues(A,E,S);T<=1&&x.push(k),T<=2&&w.push(k)}}var R=[],P={id:++m,renderer:p,solidFaces:new d.DirectionMap(d.default.weduns),getPlacedState:function(){return 0},updateNeighbors:v(x),handleNeighborUpdate:function(){}};R[m]=P;var F=[0,-1,1],D={id:++m,renderer:b,attractsWires:!0,isTransparent:!0,solidFaces:new d.DirectionMap([]),mountingDirections:[d.default.down],hotbarState:11,getPlacedState:function(){return 0},getPower:function(t){return 15&t},updateNeighbors:function(t,r,n,i){i.queueBlockUpdate().set(r,w);for(var s=null,u=null,c=0;c<4;c++){var l=7-c,h=d.default.wens[c];if(n&1<<l){var f=a.vec3.create();if(a.vec3.add(f,r,h),u=u||[null,0],o.Grid.getN(t,f,u),!u[0]||u[0]==e.blocks.dust)continue;s=s||[],a.vec3.add(f,f,d.default.up),s.push(a.vec3.clone(f)),a.vec3.add(f,f,d.default.down),a.vec3.add(f,f,d.default.down),s.push(f)}}s&&i.queueBlockUpdate().set(r,s)},handleNeighborUpdate:function(t,r,n,i){for(var s=[null,0],u=0,c=!1,h=0,v=a.vec3.create(),m=0;m<F.length;m++)for(var g=F[m],M=0;M<d.default.wens.length;M++){var p=d.default.wens[M];if(a.vec3.add(v,r,p),-1===g&&a.vec3.add(v,v,d.default.down),1===g&&a.vec3.add(v,v,d.default.up),o.Grid.inBounds(t,v)&&(o.Grid.getN(t,v,s),s[0])){var b=0===g&&!!s[0].attractsWires,_=0!==g&&s[0]===e.blocks.dust;if(b||_){if(1===g){if(a.vec3.add(v,r,d.default.up),(y=o.Grid.getBlockN(t,v))&&!y.isTransparent)continue}else if(-1===g){var y,x;if(a.vec3.add(v,r,p),(y=o.Grid.getBlockN(t,v))&&!y.isTransparent)continue;if(a.vec3.add(v,r,d.default.down),(x=o.Grid.getBlockN(t,v))&&x.preventDownwardsTransmission)continue}u|=1<<7-M,c=!0,s[0]===e.blocks.dust&&(h=f(h,s[0].getPower(s[1])-1)),1===g&&(a.vec3.add(v,r,p),(x=o.Grid.getBlockN(t,v))&&x.preventDownwardsTransmission||(u|=1<<11-M))}}}for(u|=c?0:4096&n,M=0;M<6;M++){p=d.default.weduns[M],a.vec3.add(v,r,p),h=f(h,l.getStrongPower(t,v));var A=o.Grid.getBlockN(t,v);A&&A.getPower&&A!==e.blocks.dust&&(h=f(h,A.getPower(o.Grid.getStateN(t,v))))}(u|=h&=15)!==n&&(o.Grid.set(t,r,D,u),i.queueBlockUpdate().set(v,w))},isFacing:function(t,e){d.default.checkCardinalVector(e);var r=!!(128&t),n=!!(64&t),a=!!(32&t),o=!!(16&t);return!((!(e[0]<0)||!r&&(!n||r||a||o))&&(!(e[0]>0)||!n&&(!r||n||a||o))&&(!(e[2]<0)||!a&&(!o||r||n||a))&&(!(e[2]>0)||!o&&(!a||r||n||o))&&(r||n||a||o||4096&t))},getMountedDirection:function(t){return d.default.down}};R[m]=D;var G={id:++m,renderer:_,preventDownwardsTransmission:!0,isTransparent:!0,solidFaces:new d.DirectionMap([d.default.up]),getPlacedState:function(){return 0},updateNeighbors:v(x),handleNeighborUpdate:function(){}};R[m]=G;var L={id:++m,renderer:y,isTransparent:!0,attractsWires:!0,solidFaces:new d.DirectionMap([]),mountingDirections:n(d.default.wens,[d.default.down]),getPower:function(t){return L.isEnabled(t)?15:0},getPlacedState:function(t){return d.default.equals(d.default.down,t)?0:d.default.equals(d.default.west,t)?1:d.default.equals(d.default.east,t)?2:d.default.equals(d.default.north,t)?3:4},updateNeighbors:v(w),handleNeighborUpdate:function(t,e,r,n){var o=a.vec3.create(),i=L.getMountedDirection(r);a.vec3.add(o,e,i);var s=l.getWeakPower(t,o)>0||l.getStrongPower(t,o)>0,u=L.isEnabled(r);if(s){if(u){var c=n.getScheduledQTick(e);c&&!c.customData[0]&&n.tryCancelQTick(e),n.tryScheduleQTick(e,2,0,L._onQTickCompleted,[!1,r])}}else s||u||n.tryScheduleQTick(e,2,0,L._onQTickCompleted,[!0,r])},getMountedDirection:function(t){var e=7&t;return 0===e?d.default.down:1===e?d.default.west:2===e?d.default.east:3===e?d.default.north:d.default.south},isEnabled:function(t){return 0==(8&t)},_onQTickCompleted:function(t){var r=t.customData,n=(r[0]?0:8)|7&r[1];o.Grid.trySetState(t.grid,t.location,e.blocks.torch,n)}};R[m]=L,e.blocks={stone:P,dust:D,slab:G,torch:L,blockRegistry:R,byId:function(t,r){var n=e.blocks.blockRegistry[t];if(!n&&!r)throw new Error("Tried to find a block with an invalid ID: "+t);return n||null}}},202:(t,e,r)=>{e.__esModule=!0;var n=r(287),a=r(120),o=r(111),i={_vao:null,_vbo:null,_ebo:null,_program:null,_loc_mvp:null,_loc_cursorPos:null,_loc_cursorSize:null,_loc_time:null,_loc_renderFaces:null,_renderFaces:null,init:function(){for(var t=[],e=0;e<6;e++)t.push(1),t.push(1),t.push(e),t.push(1),t.push(0),t.push(e),t.push(2),t.push(1),t.push(e),t.push(2),t.push(0),t.push(e);var r=n.Model.use(n.models.texturedCube,{nPerVertex:3,data:t},null,!1);i._vao=gl.createVertexArray(),i._vbo=gl.createBuffer(),i._ebo=gl.createBuffer();var o=a.initShader("cursor_vert",cursorVertSrc,gl.VERTEX_SHADER),s=a.initShader("cursor_frag",cursorFragSrc,gl.FRAGMENT_SHADER);for(i._program=a.initProgram(o,s),i._loc_mvp=gl.getUniformLocation(i._program,"mvp"),i._loc_cursorPos=gl.getUniformLocation(i._program,"cursorPos"),i._loc_cursorSize=gl.getUniformLocation(i._program,"cursorSize"),i._loc_time=gl.getUniformLocation(i._program,"time"),i._loc_renderFaces=gl.getUniformLocation(i._program,"renderFaces"),i._renderFaces=new Float32Array(6),e=0;e<6;e++)i._renderFaces[e]=1;gl.bindVertexArray(i._vao),gl.bindBuffer(gl.ARRAY_BUFFER,i._vbo),gl.bufferData(gl.ARRAY_BUFFER,r.vertexData,gl.STATIC_DRAW),gl.vertexAttribPointer(0,3,gl.FLOAT,!1,24,0),gl.vertexAttribPointer(1,2,gl.FLOAT,!1,24,12),gl.vertexAttribPointer(2,1,gl.FLOAT,!1,24,20),gl.enableVertexAttribArray(0),gl.enableVertexAttribArray(1),gl.enableVertexAttribArray(2),gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,i._ebo),gl.bufferData(gl.ELEMENT_ARRAY_BUFFER,r.indices,gl.STATIC_DRAW)},render:function(t,e,r){gl.disable(gl.DEPTH_TEST),gl.disable(gl.CULL_FACE),gl.bindVertexArray(i._vao),gl.useProgram(i._program),gl.uniformMatrix4fv(i._loc_mvp,!1,t.mvp),gl.uniform3f(i._loc_cursorPos,e[0],e[1],e[2]),gl.uniform1f(i._loc_cursorSize,r),gl.uniform1f(i._loc_time,t.time),gl.uniform1fv(i._loc_renderFaces,i._renderFaces,0,6),gl.drawElements(gl.TRIANGLES,36,gl.UNSIGNED_INT,0),gl.enable(gl.CULL_FACE),gl.enable(gl.DEPTH_TEST)},setShowFace:function(t,e){var r;t===o.default.west?r=1:t===o.default.east?r=2:t===o.default.north?r=3:t===o.default.south?r=4:t===o.default.up?r=0:t===o.default.down&&(r=5),i._renderFaces[r]=e?1:0},showAllFaces:function(){for(var t=0;t<6;t++)i._renderFaces[t]=1}};e.default=i},111:(t,e,r)=>{e.__esModule=!0,e.DirectionMap=void 0;var n=r(887),a=Math.sign,o=n.vec3.fromValues(-1,0,0),i=n.vec3.fromValues(1,0,0),s=n.vec3.fromValues(0,-1,0),u=n.vec3.fromValues(0,1,0),c=n.vec3.fromValues(0,0,-1),l=n.vec3.fromValues(0,0,1),d=n.vec3.fromValues(0,0,0),h=[o,i,c,l],f=[o,i,s,u,c,l],v=[o,i,c,l,s,u],m=[d,o,i,c,l,s,u],g=[o,i,c,l,u],M=[d],p=function(){function t(t){this.values=new Array(6);for(var e=0;e<6;e++)this.values[e]=!1;for(e=0;e<t.length;e++)for(var r=t[e],n=0;n<6;n++)b(f[n],r)&&(this.values[n]=!0)}return t.prototype.query=function(t){return b(t,o)?this.values[0]:b(t,i)?this.values[1]:b(t,s)?this.values[2]:b(t,u)?this.values[3]:b(t,c)?this.values[4]:!!b(t,l)&&this.values[5]},t}();e.DirectionMap=p;var b=function(t,e){return a(t[0])===a(e[0])&&a(t[1])===a(e[1])&&a(t[2])===a(e[2])};e.default={west:o,east:i,down:s,up:u,north:c,south:l,none:d,wens:h,weduns:f,wensdu:v,xwensdu:m,wensu:g,x:M,checkCardinalVector:function(t){if(1!=(0!==t[0]?1:0)+(0!==t[1]?1:0)+(0!==t[2]?1:0))throw new Error("Not a cardinal direction vector: ["+t[0]+", "+t[1]+", "+t[2]+"]")},equals:b,arrContains:function(t,e){for(var r=0;r<t.length;r++)if(b(e,t[r]))return!0;return!1}}},831:(t,e,r)=>{e.__esModule=!0,e.loadScenario=void 0;var n=r(39),a=r(462),o=r(116),i={"memory-cell":function(t,e){a.Grid.resize(t,[0,-1,0],[3,2,0]),a.Grid.set(t,[0,0,0],n.blocks.dust),a.Grid.set(t,[1,0,0],n.blocks.stone),a.Grid.set(t,[2,0,0],n.blocks.torch,1),a.Grid.set(t,[3,0,0],n.blocks.dust),a.Grid.set(t,[0,1,0],n.blocks.torch,10),a.Grid.set(t,[1,1,0],n.blocks.stone),a.Grid.set(t,[2,1,0],n.blocks.stone),a.Grid.set(t,[0,-1,0],n.blocks.stone),a.Grid.set(t,[3,-1,0],n.blocks.stone);for(var r=0;r<4;r++)e.doGameTick();for(a.Grid.set(t,[1,2,0],n.blocks.dust),a.Grid.set(t,[2,2,0],n.blocks.dust),r=0;r<2;r++)e.doGameTick()},"simple-power":function(t,e){a.Grid.resize(t,[0,-1,0],[3,0,0]),a.Grid.set(t,[0,0,0],n.blocks.torch);for(var r=0;r<4;r++)a.Grid.set(t,[r,-1,0],n.blocks.stone);for(r=1;r<4;r++)a.Grid.set(t,[r,0,0],n.blocks.dust);e.doGameTick()},inversion:function(t,e){a.Grid.resize(t,[-8,-1,-3],[6,0,0]);var r=function(e,r){r&&a.Grid.set(t,[-1,0,e],n.blocks.torch),a.Grid.set(t,[-1,-1,e],n.blocks.stone),a.Grid.set(t,[0,0,e],n.blocks.dust),a.Grid.set(t,[0,-1,e],n.blocks.stone),a.Grid.set(t,[1,0,e],n.blocks.stone),a.Grid.set(t,[2,0,e],n.blocks.torch,1),a.Grid.set(t,[3,0,e],n.blocks.dust),a.Grid.set(t,[3,-1,e],n.blocks.stone)};r(-3,!1),r(0,!0);for(var o=0;o<4;o++)e.doGameTick()}};e.loadScenario=function(t){var e=i[t];if(!e)return null;var r=a.Grid.new([1,1,1]),n=new o.Simulator(r);return e(r,n),[r,n]}},462:(t,e,r)=>{e.__esModule=!0,e.Grid=void 0;var n=r(39),a=r(887);Math.min,Math.max,e.Grid={new:function(t,r){e.Grid._sizeCheck(t),r=r||a.vec3.fromValues(0,0,0);var n=a.vec3.fromValues(-1,-1,-1);return a.vec3.add(n,n,t),a.vec3.add(n,n,r),{size:t,min:r,max:n,data:e.Grid._createData(t),isDirty:!0,onSet:null}},resize:function(t,r,n){var o=a.vec3.create();a.vec3.sub(o,n,r),a.vec3.add(o,o,[1,1,1]);var i=e.Grid._createData(o),s=a.vec3.create(),u=a.vec3.create();a.vec3.min(s,t.min,r),a.vec3.max(u,t.max,n);for(var c=a.vec3.create(),l=s[0];l<=u[0];l++)for(var d=s[1];d<=u[1];d++)for(var h=s[2];h<=u[2];h++)if(a.vec3.set(c,l,d,h),e.Grid._inBounds(t.min,t.max,c)&&e.Grid._inBounds(r,n,c)){var f=e.Grid.index(t,c),v=e.Grid._index(r,o,c);i[v]=t.data[f],i[v+1]=t.data[f+1]}t.size=o,t.min=r,t.max=n,t.data=i,t.isDirty=!0},inBounds:function(t,r){return e.Grid._inBounds(t.min,t.max,r)},_inBounds:function(t,e,r){return r[0]>=t[0]&&r[1]>=t[1]&&r[2]>=t[2]&&r[0]<=e[0]&&r[1]<=e[1]&&r[2]<=e[2]},index:function(t,r){return e.Grid._index(t.min,t.size,r)},_index:function(t,e,r){var n=r[0]-t[0],a=r[1]-t[1],o=r[2]-t[2];return 2*(n+a*e[0]+o*e[1]*e[0])},get:function(t,r,n){return e.Grid._get(t,r,n,!1)},getN:function(t,r,n){return e.Grid._get(t,r,n,!0)},getBlockN:function(t,r){if(!e.Grid.inBounds(t,r))return null;var a=e.Grid.index(t,r);return n.blocks.byId(t.data[a],!0)},getStateN:function(t,r){if(!e.Grid.inBounds(t,r))return null;var n=e.Grid.index(t,r);return t.data[n]?t.data[n+1]:null},_get:function(t,r,a,o){if(o){if(!e.Grid.inBounds(t,r))return a[0]=null,void(a[1]=0);e.Grid._boundsCheck(t,r)}var i=e.Grid.index(t,r);a[0]=n.blocks.byId(t.data[i],o),a[1]=t.data[i+1]},set:function(t,r,a,o){o=o||0,e.Grid._boundsCheck(t,r);var i=e.Grid.index(t,r),s=n.blocks.byId(t.data[i],!0),u=t.data[i];t.data[i]=a?a.id:0,t.data[i+1]=o,t.isDirty=!0,t.onSet&&t.onSet(r,a,o,s,u)},trySetState:function(t,r,n,a){e.Grid._boundsCheck(t,r);var o=e.Grid.index(t,r);if(t.data[o]!==n.id)return!1;var i=t.data[o+1];return t.data[o+1]=a,t.isDirty=!0,t.onSet&&t.onSet(r,n,a,n,i),!0},_boundsCheck:function(t,r){if(!e.Grid.inBounds(t,r))throw console.error("Attempted to access out-of-bounds grid coordinate, details:","Grid:",t,"Coordinates:",r),new Error("Attempted to access out-of-bounds grid coordinate")},_sizeCheck:function(t){if(t[0]<=0||t[1]<=0||t[2]<=0)throw console.error("Grid size is too small:",t),new Error("Grid sizde is too small")},_createData:function(t){for(var e=new Array(t[0]*t[1]*t[2]*2),r=0;r<e.length;r++)e[r]=0;return e}}},489:(t,e)=>{e.__esModule=!0;for(var r=[],n=65;n<=90;n++)r.push("Key"+String.fromCharCode(n));["Left","Right"].forEach((function(t){return r.push("Arrow"+t)}));for(var a=0;a<=9;a++)r.push("Digit"+a);r.push("Space"),r.push("ShiftLeft"),r.push("ShiftRight"),r.push("Escape");var o=[],i=[],s=[],u=function(t){r.indexOf(t.code)>=0&&!t.altKey&&!t.ctrlKey&&!t.metaKey&&(o[t.code]=!0,t.preventDefault())},c=function(t){r.indexOf(t.code)>=0&&!t.altKey&&!t.ctrlKey&&!t.metaKey&&(o[t.code]=!1,t.preventDefault())},l={init:function(){window.addEventListener("keydown",u),window.addEventListener("keyup",c);for(var t=0;t<r.length;t++)o[r[t]]=!1,i[r[t]]=!1},update:function(){for(var t=0;t<r.length;t++){var e=r[t];i[e]=o[e]&&!s[e],s[r[t]]=o[e]}},keyPressed:o,keyDown:i};e.default=l},634:(t,e)=>{e.__esModule=!0,e.materialRegistry=void 0,e.materialRegistry={_registry:{},createRenderer:function(t){var r=e.materialRegistry._registry[t];if(!r)throw new Error("Tried to create a MaterialRenderer for a nonexistent material '"+t+"'");return r()},add:function(t,r){if(t in e.materialRegistry._registry)throw new Error("Material '"+t+"' already registered");e.materialRegistry._registry[t]=r}}},287:(t,e,r)=>{e.__esModule=!0,e.models=e.Model=void 0;var n=r(887);e.Model={use:function(t,e,r,a){if(e&&e.data.length/e.nPerVertex!==t.vertices.length){var o=e.nPerVertex*t.vertices.length,i=e.data.length;throw Error("Wrong amount of extra data; expected "+o+" at "+e.nPerVertex+"/vertex, got "+i)}for(var s,u=3+(e&&e.nPerVertex||0),c=new Array(t.vertices.length*u),l=n.vec3.create(),d=0;d<t.vertices.length;d++)if(n.vec3.copy(l,t.vertices[d]),r&&n.vec3.transformMat4(l,l,r),c[d*u+0]=l[0],c[d*u+1]=l[1],c[d*u+2]=l[2],e)for(var h=e.nPerVertex*d,f=0;f<e.nPerVertex;f++)c[d*u+3+f]=e.data[h+f];if(a)for(s=new Uint32Array(t.indices.length),d=0;d<s.length;d+=3)for(f=0;f<3;f++)s[d+f]=t.indices[d+(2-f)];else s=Uint32Array.from(t.indices);return{vertexData:Float32Array.from(c),indices:s,dataPerVertex:u}}};for(var a={vertices:[[0,0,0],[1,0,0],[1,0,1],[0,0,1],[0,1,0],[1,1,0],[1,1,1],[0,1,1]],indices:[4,7,5,5,7,6,4,0,7,7,0,3,6,2,5,5,2,1,5,1,4,4,1,0,7,3,6,6,3,2,1,2,0,0,2,3]},o={vertices:[],indices:[]},i=0,s=0;s<a.indices.length/6;s++){var u=6*s;o.vertices.push(a.vertices[a.indices[u]]),o.vertices.push(a.vertices[a.indices[u+1]]),o.vertices.push(a.vertices[a.indices[u+2]]),o.vertices.push(a.vertices[a.indices[u+5]]),o.indices.push(i),o.indices.push(i+1),o.indices.push(i+2),o.indices.push(i+2),o.indices.push(i+1),o.indices.push(i+3),i+=4}var c={vertices:[],indices:[]},l=n.vec3.create();for(s=0;s<o.vertices.length/4;s++){var d=n.vec3.clone(o.vertices[4*s]),h=n.vec3.clone(o.vertices[4*s+1]),f=n.vec3.clone(o.vertices[4*s+2]),v=n.vec3.clone(o.vertices[4*s+3]),m=0,g=0,M=0;0===s?g=-2/8:1===s?m=.375:2===s?m=-.375:3===s?M=.375:4===s&&(M=-.375),n.vec3.set(l,m,g,M),n.vec3.add(d,d,l),n.vec3.add(h,h,l),n.vec3.add(f,f,l),n.vec3.add(v,v,l),c.vertices[4*s]=d,c.vertices[4*s+1]=h,c.vertices[4*s+2]=f,c.vertices[4*s+3]=v}for(s=0;s<o.indices.length;s++)c.indices.push(o.indices[s]);e.models={triangle:{vertices:[[-.5,-.5,0],[.5,-.5,0],[0,.5,0]],indices:[0,1,2]},quad:{vertices:[[0,0,0],[0,1,0],[1,1,0],[1,0,0]],indices:[0,2,1,2,0,3]},cube:a,texturedCube:o,torch:c}},393:(t,e,r)=>{e.__esModule=!0,e.useUvs=e.HotbarRenderer=e.LayeredGridRenderer=e.LayerRenderer=e.ModelCombiner=void 0;var n=r(120),a=r(882),o=r(887),i=r(462),s=r(287),u=r(634),c=r(25),l=(Math.abs,Math.min),d=Math.max,h=Math.floor;e.ModelCombiner={new:function(){return{_modelBuffer:[],_totalVertices:0,_totalIndices:0}},addModel:function(t,e){t._modelBuffer.push(e),t._totalVertices+=e.vertexData.length,t._totalIndices+=e.indices.length},combine:function(t){for(var e=new Array(t._totalVertices),r=new Array(t._totalIndices),n=0,a=0,o=0,i=0;i<t._modelBuffer.length;i++){for(var s=t._modelBuffer[i],u=0;u<s.vertexData.length;u++)e[n++]=s.vertexData[u];for(u=0;u<s.indices.length;u++)r[a++]=s.indices[u]+o;o+=s.vertexData.length/s.dataPerVertex}return{vertexData:Float32Array.from(e),indices:Uint32Array.from(r),dataPerVertex:null}},clear:function(t){t._modelBuffer.splice(0),t._totalVertices=0,t._totalIndices=0}};var f=function(){function t(){this._materials={},this._materialKeys=[]}return t.prototype.updateModels=function(t,r,n,a){a=a||5e4;var s=t.min[0],h=t.max[0],f=t.min[1],v=t.max[1],m=t.min[2],g=t.max[2];if(r[0]){var M=r[0]*n,p=r[0]*a;s=d(s,l(M,p)),h=l(h,d(M,p))}r[1]&&(M=r[1]*n,p=r[1]*a,f=d(f,l(M,p)),v=l(v,d(M,p))),r[2]&&(M=r[2]*n,p=r[2]*a,m=d(m,l(M,p)),g=l(g,d(M,p)));for(var b=o.vec3.create(),_=s;_<=h;_++)for(var y=f;y<=v;y++)for(var x=m;x<=g;x++){o.vec3.set(b,_,y,x);var w=[null,0];i.Grid.getN(t,b,w);var A=w[0],E=w[1];if(A){var S=A.renderer.materialName;if(!this._materials[S]){var T=c.default(e.ModelCombiner.new(),u.materialRegistry.createRenderer(S));T[1].init(),this._materials[S]=T,this._materialKeys.push(S)}var k=this._materials[S],R=k[0];k[1],A.renderer.render(t,b,A,E,R)}}for(var P=0;P<this._materialKeys.length;P++){S=this._materialKeys[P];var F=this._materials[S],D=(R=F[0],F[1]),G=e.ModelCombiner.combine(R);D.uploadCombinedModel(G),e.ModelCombiner.clear(R)}},t.prototype.render=function(t,e){for(var r=0;r<this._materialKeys.length;r++){var n=this._materialKeys[r],a=this._materials[n];a[0],a[1].renderCombinedModel(t,e)}},t}();e.LayerRenderer=f;var v=[.2,1,.3,.1],m=function(){function t(){this._layers=new Array(4),this._layers[0]=new f,this._layers[1]=new f,this._layers[2]=new f,this._layers[3]=new f,this._facingAxis=o.vec3.create(),this._centerPos=o.vec3.create(),this.fadeLayers=!0}return t.prototype.setCamera=function(t,e){o.vec3.copy(this._facingAxis,t),o.vec3.copy(this._centerPos,e),-0===this._facingAxis[0]&&(this._facingAxis[0]=0)},t.prototype.updateModels=function(t){var e=this._facingAxis,r=this._centerPos,n=Math.round(o.vec3.dot(e,r));this._layers[0].updateModels(t,this._facingAxis,n+1,n+1e4),this._layers[1].updateModels(t,this._facingAxis,n),this._layers[2].updateModels(t,this._facingAxis,n-1,n-1),this._layers[3].updateModels(t,this._facingAxis,n-2,n-2)},t.prototype.render=function(t){for(var e=0;e<4;e++){var r=this.fadeLayers?v[e]:1;this._layers[e].render(t,r)}},t}();e.LayeredGridRenderer=m;var g=function(){function t(){var t=n.initShader("hotbar_vert",hotbarVertSrc,gl.VERTEX_SHADER),e=n.initShader("hotbar_frag",hotbarFragSrc,gl.FRAGMENT_SHADER);this._prog=n.initProgram(t,e),this._loc_screenDimensions=gl.getUniformLocation(this._prog,"screenDimensions"),this._loc_uiPosition=gl.getUniformLocation(this._prog,"uiPosition"),this._loc_cellParameters=gl.getUniformLocation(this._prog,"cellParameters"),this._loc_selectTime=gl.getUniformLocation(this._prog,"selectTime");var r=s.Model.use(s.models.quad);this._vao=gl.createVertexArray();var a=gl.createBuffer(),o=gl.createBuffer();gl.bindVertexArray(this._vao),gl.bindBuffer(gl.ARRAY_BUFFER,a),gl.bufferData(gl.ARRAY_BUFFER,r.vertexData,gl.STATIC_DRAW),gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,o),gl.bufferData(gl.ELEMENT_ARRAY_BUFFER,r.indices,gl.STATIC_DRAW),gl.vertexAttribPointer(0,3,gl.FLOAT,!1,12,0),gl.enableVertexAttribArray(0)}return t.prototype.render=function(t,e,r,n,a,o,i,s,u,c,l){gl.bindVertexArray(this._vao),gl.useProgram(this._prog),gl.uniform2f(this._loc_screenDimensions,t,e),gl.uniform4f(this._loc_uiPosition,r,n,a,o),gl.uniform4f(this._loc_cellParameters,i,s,u,c),gl.uniform1f(this._loc_selectTime,l),gl.drawElements(gl.TRIANGLES,6,gl.UNSIGNED_INT,0)},t}(),M=function(){function t(t){this._ui=new g,this._renderers=[],this._rotations=[];for(var r=e.ModelCombiner.new(),n=i.Grid.new([1,1,1]),a=0,o=t;a<o.length;a++){var s=o[a];e.ModelCombiner.clear(r),s.renderer.render(n,[0,0,0],s,s.hotbarState||0,r);var l=u.materialRegistry.createRenderer(s.renderer.materialName);l.init(),l.uploadCombinedModel(e.ModelCombiner.combine(r)),this._renderers.push(c.default(s,l)),this._rotations.push(0)}}return t.prototype.render=function(t,e,r,n,i,s,u){for(var c=a.clamp(.05*n,4,45),l=r/2+-this._renderers.length/2*75,d=c+5,h=0,f=0;f<this._renderers.length;f++)i===this._renderers[f][0]&&(h=f);for(gl.disable(gl.DEPTH_TEST),this._ui.render(r,n,l-5,d-5,75*this._renderers.length+10-25,60,50,25,5,h,t-u),gl.enable(gl.DEPTH_TEST),f=0;f<this._renderers.length;f++){var v=new Float32Array(16),m=o.mat4.create(),g=o.mat4.create(),M=this._renderers[f][0]===i,p=this._renderers[f][0]===s,b=M?this._generateTransition(t,u,8):p?1-this._generateTransition(t,u,16):0,_=M?this._generateTransition(t,u,4):p?1-this._generateTransition(t,u,8):0;o.mat4.ortho(g,-.75,.75,-.75,.75,.1,100),o.mat4.identity(m),o.mat4.translate(m,m,[0,0*(.125+.05*_)*Math.cos(2*Math.PI*.5*t),-5]),o.mat4.rotateX(m,m,Math.PI*(.08+.08*b));var y=M?this._rotations[f]+=2*Math.PI*.15*e*b:a.lerp(a.normalizeRad(this._rotations[f]),2*Math.PI*-.05,8*(t-u));M||(this._rotations[f]=y),o.mat4.rotateY(m,m,y);var x=1+.2*b;o.mat4.scale(m,m,[x,x,x]),o.mat4.translate(m,m,[-.5,0*b-.5,-.5]),o.mat4.identity(v),o.mat4.mul(v,g,m);var w=50/r,A=50/n,E=(l+75*f)/r,S=d/n,T=o.mat4.create();o.mat4.identity(T),o.mat4.translate(T,T,[2*E-1,2*S-1,0]),o.mat4.scale(T,T,[w,A,1]),o.mat4.translate(T,T,[1,1,0]),o.mat4.mul(v,T,v);var k={mvp:v,time:0};this._renderers[f][1].renderCombinedModel(k,1)}},t.prototype._generateTransition=function(t,e,r){return a.clamp((t-e)*r,0,1)},t}();e.HotbarRenderer=M,e.useUvs=function(t,e,r,n,a){if(a=a||2,0!==(n=n||0)&&90!==n&&180!==n&&270!==n)throw new Error("Rotation not a valid value: "+n);var o=.01,i=t%8+o,s=h(t/8)+o,u=i+1-2*o,c=s+1-2*o,l=i,d=s,f=i,v=c,m=u,g=s,M=u,p=c,b=a;0===n?(e[r+0*b+0]=l,e[r+0*b+1]=d,e[r+1*b+0]=f,e[r+1*b+1]=v,e[r+2*b+0]=m,e[r+2*b+1]=g,e[r+3*b+0]=M,e[r+3*b+1]=p):90===n?(e[r+0*b+0]=f,e[r+0*b+1]=v,e[r+1*b+0]=M,e[r+1*b+1]=p,e[r+2*b+0]=l,e[r+2*b+1]=d,e[r+3*b+0]=m,e[r+3*b+1]=g):180===n?(e[r+0*b+0]=M,e[r+0*b+1]=p,e[r+1*b+0]=m,e[r+1*b+1]=g,e[r+2*b+0]=f,e[r+2*b+1]=v,e[r+3*b+0]=l,e[r+3*b+1]=d):(e[r+0*b+0]=m,e[r+0*b+1]=g,e[r+1*b+0]=l,e[r+1*b+1]=d,e[r+2*b+0]=M,e[r+2*b+1]=p,e[r+3*b+0]=f,e[r+3*b+1]=v)}},120:(t,e)=>{e.__esModule=!0,e.initProgram=e.initShader=void 0,e.initShader=function(t,e,r){var n=gl.createShader(r);return gl.shaderSource(n,e),gl.compileShader(n),gl.getShaderParameter(n,gl.COMPILE_STATUS)?n:(console.error("Error compiling shader "+t,gl.getShaderInfoLog(n)),console.error(e.split("\n").reduce((function(t,e,r){return t+"\n"+("   "+(r+1)).slice(-3)+" "+e}),"")),alert("Shader compilation error: "+t),null)},e.initProgram=function(t,e){var r=gl.createProgram();return gl.attachShader(r,t),gl.attachShader(r,e),gl.linkProgram(r),gl.getProgramParameter(r,gl.LINK_STATUS)?r:(console.error("Error linking program",gl.getProgramInfoLog(r)),alert("Program linkage error"),null)}},116:(t,e,r)=>{e.__esModule=!0,e.getStrongPower=e.getWeakPower=e.Simulator=e.BlockUpdate=e.QTick=void 0;var n=r(882),a=r(887),o=r(462),i=r(39),s=r(111),u=(Math.min,Math.max),c=function(t){this.location=a.vec3.clone(t),this.isFree=!0};e.QTick=c;var l=function(){function t(){this._data=new Map}return t.prototype.get=function(t){return this._data.get(this._hash(t))},t.prototype.getOrCreate=function(t){var e=this._hash(t),r=this._data.get(e);return r||(r=new c(t),this._data.set(e,r)),r},t.prototype._hash=function(t){return t[0]+512<<0|t[1]+512<<10|t[2]+512<<20},t}(),d=function(){function t(){this.location=a.vec3.create(),this.updateOrder=null,this.needsSet=!0}return t.prototype.set=function(t,e){a.vec3.copy(this.location,t),this.updateOrder=e,this.needsSet=!1},t.prototype.setPostPlacement=function(t){this.set(t,s.default.xwensdu)},t}();e.BlockUpdate=d;var h=function(){function t(t,e){this.grid=t,this.activeQticks=new n.LinkedList,this.qtickGrid=new l,this.sortedQticks=[],this.tickCount=0,this.blockUpdatePool=[],this.blockUpdateLength=0,this.tempVec3=a.vec3.create(),this.tempOut=[null,0],(void 0===e||e)&&this._installGridHooks()}return t.prototype.doGameTick=function(){for(var t=this.activeQticks.iterator();t.hasNext();)(r=t.next()).delay--,r.delay<=0&&(t.remove(),this.sortedQticks.push(r));this.sortedQticks.sort((function(t,e){return t.priority-e.priority}));for(var e=0;e<this.sortedQticks.length;e++){var r;(r=this.sortedQticks[e]).onCompleted(r),r.isFree=!0}this.sortedQticks.splice(0),this.tickCount++%2==0&&this._doRedstoneTick()},t.prototype.queueBlockUpdate=function(){var t=this.blockUpdatePool[this.blockUpdateLength];return t||(t=new d,this.blockUpdatePool[this.blockUpdateLength]=t),this.blockUpdateLength++,t.needsSet=!0,t},t.prototype.getScheduledQTick=function(t){var e=this.qtickGrid.get(t);return e&&!e.isFree?e:null},t.prototype.tryScheduleQTick=function(t,e,r,n,a){var o=this.qtickGrid.getOrCreate(t);return!!o.isFree&&(o.priority=r,o.delay=e,o.onCompleted=n,o.grid=this.grid,o.customData=a,o.isFree=!1,this.activeQticks.push(o),!0)},t.prototype.tryCancelQTick=function(t){var e=this.qtickGrid.getOrCreate(t);return!e.isFree&&(e.isFree=!0,this.activeQticks.remove(e),!0)},t.prototype._doRedstoneTick=function(){for(var t=this.tempVec3,e=this.tempOut,r=0;r<this.blockUpdateLength;r++){var n=this.blockUpdatePool[r];if(n.needsSet)throw new Error("Block update was retrieved from the pool but wasn't setup corrctly");for(var i=0;i<n.updateOrder.length;i++){a.vec3.add(t,n.location,n.updateOrder[i]),o.Grid.getN(this.grid,t,e);try{e[0]&&e[0].handleNeighborUpdate(this.grid,t,e[1],this)}catch(t){console.error(t)}}}this.blockUpdateLength=0},t.prototype._installGridHooks=function(){var t=this;this.grid.onSet=function(e,r,n,a,o){t.queueBlockUpdate().set(e,s.default.x),a&&a.updateNeighbors(t.grid,e,o,t),r&&r.updateNeighbors(t.grid,e,n,t)}},t}();e.Simulator=h;var f=function(t,e){var r=o.Grid.getBlockN(t,e);return r&&!r.isTransparent};e.getWeakPower=function(t,e){if(!f(t,e))return 0;for(var r=0,n=a.vec3.create(),c=0;c<4;c++){var l=s.default.wens[c];if(a.vec3.add(n,e,l),o.Grid.getBlockN(t,n)===i.blocks.dust){var d=o.Grid.getStateN(t,n);a.vec3.negate(n,l),i.blocks.dust.isFacing(d,n)&&(r=u(r,i.blocks.dust.getPower(d)))}}return a.vec3.add(n,e,s.default.up),o.Grid.getBlockN(t,n)===i.blocks.dust&&(d=o.Grid.getStateN(t,n),r=u(r,i.blocks.dust.getPower(d))),r},e.getStrongPower=function(t,e){if(!f(t,e))return 0;var r=0,n=a.vec3.create();a.vec3.add(n,e,s.default.down);var c=o.Grid.getBlockN(t,n);if(c&&c===i.blocks.torch){var l=o.Grid.getStateN(t,n);r=u(r,i.blocks.torch.getPower(l))}return r}},25:(t,e)=>{e.__esModule=!0,e.default=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t}},882:(t,e)=>{e.__esModule=!0,e.adjacentPositions=e.LinkedList=e.GuillotineArray=e.normalizeRad=e.lerp=e.clamp=void 0;var r=Math.min,n=Math.max;e.clamp=function(t,e,a){return n(e,r(a,t))},e.lerp=function(t,r,n){return t+(r-t)*e.clamp(n,0,1)},e.normalizeRad=function(t){var e=t%(2*Math.PI);return e>=Math.PI&&(e-=2*Math.PI),e};var a=function(){function t(t){this._data=new Array(t||16),this._startIndex=0,this._lastIndexExclusive=0}return t.prototype.get=function(t){var e=(t+this._startIndex)%this._data.length;return this._data[e]},t.prototype.set=function(t,e){t>=this._data.length&&this._resize(t+1);var r=(t+this._startIndex)%this._data.length;this._data[r]=e,this._lastIndexExclusive++,this._lastIndexExclusive%=this._data.length},t.prototype.push=function(t){this.set(this.length(),t)},t.prototype.popHead=function(){if(this._startIndex===this._lastIndexExclusive)throw new Error("Array is empty");var t=this._data[this._startIndex];return this._data[this._startIndex]=void 0,this._startIndex++,this._startIndex%=this._data.length,t},t.prototype.length=function(){var t=this._lastIndexExclusive;return t<this._startIndex&&(t+=this._data.length),t-this._startIndex},t.prototype._resize=function(t){for(var e=n(2*this._data.length,t),r=new Array(e),a=this.length(),o=0;o<a;o++)r[o]=this.get(o);this._data=r,this._startIndex=0,this._lastIndexExclusive=a},t}();e.GuillotineArray=a;var o=function(){function t(t){this.node=null,this.onRemove=t}return t.prototype._setup=function(t){this.node=t},t.prototype.next=function(){if(this.node.next.special)throw new Error("Reached end of list");return this.node=this.node.next,this.node.value},t.prototype.hasNext=function(){return!this.node.next.special},t.prototype.remove=function(){if(this.node.special)throw new Error("To remove a node, call next(), then remove() will remove that node");var t=this.node.prev,e=this.node.next;t.next=e,e.prev=t,this.onRemove()},t}(),i=function(){function t(){var t=this;this._length=0,this.head={value:null,prev:null,next:null,special:"head"},this.tail={value:null,prev:null,next:null,special:"tail"},this.head.next=this.tail,this.tail.prev=this.head,this.it=new o((function(){return t._length--}))}return t.prototype.get=function(t){this._indexCheck(t);for(var e=this.head,r=0;r<=t;r++)e=e.next;return e.value},t.prototype.set=function(t,e){this._indexCheck(t);for(var r=this.head,n=0;n<=t;n++)r=r.next;r.value=e},t.prototype.push=function(t){var e={value:t,prev:this.tail.prev,next:this.tail};this.tail.prev.next=e,this.tail.prev=e,this._length++},t.prototype.remove=function(t){for(var e=this.iterator();e.hasNext();)if(e.next()===t)return e.remove(),!0;return!1},t.prototype.iterator=function(){return this.it._setup(this.head),this.it},t.prototype.length=function(){return this._length},t.prototype._indexCheck=function(t){if(t<0||t>=this._length)throw new Error("Index out of bounds: "+t)},t}();e.LinkedList=i,e.adjacentPositions=[[-1,0,0],[1,0,0],[0,-1,0],[0,1,0],[0,0,-1],[0,0,1]]}},e={};function r(n){if(e[n])return e[n].exports;var a=e[n]={exports:{}};return t[n].call(a.exports,a,a.exports,r),a.exports}r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{r(985);var t,e=r(393),n=r(462),a=r(887),o=r(39),i=r(111),s=r(202),u=r(489),c=r(181),l=r(882),d=r(831),h=r(366),f=r(275),v=r(364),m=r(0),g=r(895),M=r(195),p=r(845),b=r(353),_=null,y=null,x=(n.Grid.new([1,1,1]),Math.cos),w=Math.sin,A=Math.min,E=Math.round,S=function(t,e,r){return t*(1-r)+e*r},T=!1,k=function(){_.width=t.offsetWidth,_.height=t.offsetHeight,T=!0};window.onload=function(){document.querySelectorAll('a[href^="#scroll--"]').forEach((function(t){var e=t.href.substring(t.href.indexOf("scroll--")+"scroll--".length);t.setAttribute("href","javascript:void");var r=document.getElementById("scroll--"+e);r&&(r.setAttribute("id",""),t.addEventListener("click",(function(t){var e,n;if(r){document.querySelector("#info-bar").scrollTop=r.offsetTop-10;var a="highlighted-element";null===(n=null===(e=document.querySelector("."+a))||void 0===e?void 0:e.classList)||void 0===n||n.remove(a),r.classList.add(a),r.style.animation="none",r.offsetHeight,r.style.animation=null}})))}));var r=document.getElementsByTagName("body")[0].classList;if(r.remove("js-fail","js-noscript"),u.default.init(),_=document.getElementById("canvas"),t=document.querySelector("#canvas-wrapper"),k(),new window.ResizeObserver(k).observe(t),null!==(y=window.gl=_.getContext("webgl2"))){window.testVertSrc=h.default,window.testFragSrc=f.default,window.dustVertSrc=v.default,window.dustFragSrc=m.default,window.cursorVertSrc=g.default,window.cursorFragSrc=M.default,window.hotbarVertSrc=p.default,window.hotbarFragSrc=b.default,y.clearColor(.058,.063,.072,1),y.enable(y.CULL_FACE),y.enable(y.DEPTH_TEST),y.cullFace(y.BACK),y.enable(y.BLEND),y.blendFunc(y.SRC_ALPHA,y.ONE_MINUS_SRC_ALPHA);var R=y.createTexture(),P=[.2,1,-.2];a.vec3.normalize(P,P);var F,D,G=a.mat4.create(),L=a.mat4.create(),U=a.mat4.create(),I=new Float32Array(16),C=a.vec3.create(),q=[0,0,7.5],B=.15,N=0,V=a.vec3.create(),z=a.vec3.create(),Y=a.vec3.create(),O=B,Q=0,X=O,H=-0,K=0,W=H,j=0,Z=0,J=0,$=[.5,.5,.5],tt=o.blocks.stone,et=null,rt=-100,nt=!1;window.loadScenario=function(t){var e=d.loadScenario(t);if(!e)throw new Error('Scenario "'+t+'" not found');var r=e[0],n=e[1];F=r,D=n,a.vec3.set(V,0,0,0),O=B,H=-0,j=0,nt=!1},window.loadScenario("memory-cell");var at=new e.LayeredGridRenderer;at.setCamera([0,0,-1],a.vec3.create()),at.updateModels(F),s.default.init();var ot=0,it=null,st={mvp:I,time:ot},ut=new e.HotbarRenderer(o.blocks.blockRegistry.slice(1)),ct=function(t){if(!n.Grid.inBounds(F,V)){var e=a.vec3.create(),r=a.vec3.create();a.vec3.min(e,F.min,V),a.vec3.max(r,F.max,V),n.Grid.resize(F,e,r)}n.Grid.set(F,V,tt,tt.getPlacedState(t))},lt=function(t){a.vec3.add(C,V,t);var e=n.Grid.getBlockN(F,C);return a.vec3.negate(C,t),null!==e&&e.solidFaces.query(C)},dt=a.vec3.create(),ht=0,ft=function(t){requestAnimationFrame(ft);var e=it?.001*(t-it):.01;it=t,ot+=e,function(t){var e;u.default.update();var r=u.default.keyDown.KeyA,c=u.default.keyDown.KeyD,d=u.default.keyDown.KeyS,h=u.default.keyDown.KeyW,f=u.default.keyDown.KeyQ,v=u.default.keyDown.KeyE,m=u.default.keyPressed.ShiftLeft||u.default.keyPressed.ShiftRight,g=u.default.keyPressed.Escape;dt[0]=0,dt[1]=0,dt[2]=0,r&&!m&&(dt[0]=-x(j),dt[2]=-w(j),H=0),c&&!m&&(dt[0]=x(j),dt[2]=w(j),H=-0),d&&!m&&(dt[1]--,O=.15),h&&!m&&(dt[1]++,O=B),f&&!m&&(dt[0]=w(j),dt[2]=-x(j)),v&&!m&&(dt[0]=-w(j),dt[2]=x(j)),a.vec3.round(dt,dt),u.default.keyDown.KeyZ&&(at.fadeLayers=!at.fadeLayers);var M=!1;(u.default.keyDown.ArrowLeft||r&&m)&&(j+=1.57079633,M=!0),(u.default.keyDown.ArrowRight||c&&m)&&(j-=1.57079633,M=!0),(M||g)&&(nt=!1);for(var p=1;p<=9;p++)u.default.keyDown["Digit"+p]&&o.blocks.blockRegistry[p]&&tt!==o.blocks.blockRegistry[p]&&(et=tt,rt=ot,tt=o.blocks.blockRegistry[p]);var b=u.default.keyDown.Space,_=!a.vec3.equals(dt,i.default.none),y=!1;if(nt){if(_){var T=dt,k=i.default.arrContains(tt.mountingDirections,T),R=lt(T);k&&R&&(ct(T),nt=!1)}b&&(nt=!1)}else{if(y=_,a.vec3.add(V,V,dt),s.default.showAllFaces(),u.default.keyDown.KeyX&&n.Grid.getBlockN(F,V)==o.blocks.dust){var P=n.Grid.getStateN(F,V);4080&P||(P=(4096&P?0:4096)|4095&P,n.Grid.trySetState(F,V,o.blocks.dust,P))}if(b){var D=n.Grid.getBlockN(F,V),G=null===(e=tt.mountingDirections)||void 0===e?void 0:e.filter(lt);if(null===D&&G&&1!==G.length){if(G.length>1){for(nt=!0,p=0;p<6;p++)s.default.setShowFace(i.default.weduns[p],!1);for(p=0;p<G.length;p++)s.default.setShowFace(G[p],!0)}}else D?function(){n.Grid.set(F,V,null);for(var t=0,e=l.adjacentPositions;t<e.length;t++){var r=e[t];a.vec3.add(C,V,r);var o=n.Grid.getBlockN(F,C);if(o&&o.getMountedDirection){var i=o.getMountedDirection(n.Grid.getStateN(F,C));a.vec3.negate(C,i),a.vec3.equals(C,r)&&(a.vec3.add(C,V,r),n.Grid.set(F,C,null))}}}():ct(G?G[0]:null)}}if((y||M)&&(a.vec3.copy(z,Y),Q=X,K=W,Z=J,N=t),z){var L=A((t-N)/75,1);a.vec3.lerp(Y,z,V,L),X=S(Q,O,L),W=S(K,H,L),J=S(Z,j,L)}(y||M||F.isDirty)&&(at.setCamera([E(w(j)),0,E(-x(j))],V),at.updateModels(F),F.isDirty=!1)}(t),(ht-=e)<=0&&(D.doGameTick(),ht=.05),a.vec3.negate(C,q),a.mat4.fromTranslation(U,C),a.mat4.rotateX(U,U,X),a.mat4.rotateY(U,U,J+W),a.vec3.negate(C,Y),a.vec3.sub(C,C,$),a.mat4.translate(U,U,C),T&&(y.viewport(0,0,_.width,_.height),a.mat4.perspective(L,.9,_.width/_.height,.1,100)),a.mat4.identity(I),a.mat4.mul(I,U,G),a.mat4.mul(I,L,I),st.time=ot,y.clear(y.COLOR_BUFFER_BIT|y.DEPTH_BUFFER_BIT),y.bindTexture(y.TEXTURE_2D,R),at.render(st),s.default.render(st,V,n.Grid.getBlockN(F,V)||nt?1:.35),ut.render(ot,e,_.width,_.height,tt,et,rt),T=!1},vt=new Image;vt.src=c.default,vt.onload=function(){y.bindTexture(y.TEXTURE_2D,R),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_S,y.CLAMP_TO_EDGE),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_T,y.CLAMP_TO_EDGE),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MIN_FILTER,y.NEAREST),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MAG_FILTER,y.NEAREST),y.texImage2D(y.TEXTURE_2D,0,y.RGBA,vt.width,vt.height,0,y.RGBA,y.UNSIGNED_BYTE,vt),y.generateMipmap(y.TEXTURE_2D),ft(performance.now())}}else r.add("js-fail","js-nowebgl")}})()})();
//# sourceMappingURL=src.bundle.js.map